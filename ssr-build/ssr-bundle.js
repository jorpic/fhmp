module.exports=function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/fhmp/",n(n.s="QfWi")}({"2zjJ":function(t,e,n){},"6jwM":function(t,e,n){},"8Jek":function(t,e,n){var r;
/*!
  Copyright (c) 2017 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/
/*!
  Copyright (c) 2017 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/
!function(){"use strict";var n={}.hasOwnProperty;function i(){for(var t=[],e=0;e<arguments.length;e++){var r=arguments[e];if(r){var o=typeof r;if("string"===o||"number"===o)t.push(r);else if(Array.isArray(r)&&r.length){var s=i.apply(null,r);s&&t.push(s)}else if("object"===o)for(var a in r)n.call(r,a)&&r[a]&&t.push(a)}}return t.join(" ")}t.exports?(i.default=i,t.exports=i):void 0===(r=function(){return i}.apply(e,[]))||(t.exports=r)}()},Ax1p:function(t,e,n){!function(e){"use strict";var n={newline:/^\n+/,code:/^( {4}[^\n]+\n*)+/,fences:v,hr:/^ {0,3}((?:- *){3,}|(?:_ *){3,}|(?:\* *){3,})(?:\n+|$)/,heading:/^ *(#{1,6}) *([^\n]+?) *(?:#+ *)?(?:\n+|$)/,nptable:v,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3})(bull) [\s\S]+?(?:hr|def|\n{2,}(?! )(?!\1bull )\n*|\s*$)/,html:"^ {0,3}(?:<(script|pre|style)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?\\?>\\n*|<![A-Z][\\s\\S]*?>\\n*|<!\\[CDATA\\[[\\s\\S]*?\\]\\]>\\n*|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:\\n{2,}|$)|<(?!script|pre|style)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:\\n{2,}|$)|</(?!script|pre|style)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:\\n{2,}|$))",def:/^ {0,3}\[(label)\]: *\n? *<?([^\s>]+)>?(?:(?: +\n? *| *\n *)(title))? *(?:\n+|$)/,table:v,lheading:/^([^\n]+)\n *(=|-){2,} *(?:\n+|$)/,paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading| {0,3}>|<\/?(?:tag)(?: +|\n|\/?>)|<(?:script|pre|style|!--))[^\n]+)*)/,text:/^[^\n]+/};function r(t){this.tokens=[],this.tokens.links=Object.create(null),this.options=t||_.defaults,this.rules=n.normal,this.options.pedantic?this.rules=n.pedantic:this.options.gfm&&(this.options.tables?this.rules=n.tables:this.rules=n.gfm)}n._label=/(?!\s*\])(?:\\[\[\]]|[^\[\]])+/,n._title=/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/,n.def=f(n.def).replace("label",n._label).replace("title",n._title).getRegex(),n.bullet=/(?:[*+-]|\d{1,9}\.)/,n.item=/^( *)(bull) ?[^\n]*(?:\n(?!\1bull ?)[^\n]*)*/,n.item=f(n.item,"gm").replace(/bull/g,n.bullet).getRegex(),n.list=f(n.list).replace(/bull/g,n.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+n.def.source+")").getRegex(),n._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",n._comment=/<!--(?!-?>)[\s\S]*?-->/,n.html=f(n.html,"i").replace("comment",n._comment).replace("tag",n._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),n.paragraph=f(n.paragraph).replace("hr",n.hr).replace("heading",n.heading).replace("lheading",n.lheading).replace("tag",n._tag).getRegex(),n.blockquote=f(n.blockquote).replace("paragraph",n.paragraph).getRegex(),n.normal=m({},n),n.gfm=m({},n.normal,{fences:/^ {0,3}(`{3,}|~{3,})([^`\n]*)\n(?:|([\s\S]*?)\n)(?: {0,3}\1[~`]* *(?:\n+|$)|$)/,paragraph:/^/,heading:/^ *(#{1,6}) +([^\n]+?) *#* *(?:\n+|$)/}),n.gfm.paragraph=f(n.paragraph).replace("(?!","(?!"+n.gfm.fences.source.replace("\\1","\\2")+"|"+n.list.source.replace("\\1","\\3")+"|").getRegex(),n.tables=m({},n.gfm,{nptable:/^ *([^|\n ].*\|.*)\n *([-:]+ *\|[-| :]*)(?:\n((?:.*[^>\n ].*(?:\n|$))*)\n*|$)/,table:/^ *\|(.+)\n *\|?( *[-:]+[-| :]*)(?:\n((?: *[^>\n ].*(?:\n|$))*)\n*|$)/}),n.pedantic=m({},n.normal,{html:f("^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:\"[^\"]*\"|'[^']*'|\\s[^'\"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))").replace("comment",n._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/}),r.rules=n,r.lex=function(t,e){return new r(e).lex(t)},r.prototype.lex=function(t){return t=t.replace(/\r\n|\r/g,"\n").replace(/\t/g,"    ").replace(/\u00a0/g," ").replace(/\u2424/g,"\n"),this.token(t,!0)},r.prototype.token=function(t,e){var r,i,o,s,a,u,c,l,h,f,p,d,g,v,m,w;for(t=t.replace(/^ +$/gm,"");t;)if((o=this.rules.newline.exec(t))&&(t=t.substring(o[0].length),o[0].length>1&&this.tokens.push({type:"space"})),o=this.rules.code.exec(t))t=t.substring(o[0].length),o=o[0].replace(/^ {4}/gm,""),this.tokens.push({type:"code",text:this.options.pedantic?o:y(o,"\n")});else if(o=this.rules.fences.exec(t))t=t.substring(o[0].length),this.tokens.push({type:"code",lang:o[2]?o[2].trim():o[2],text:o[3]||""});else if(o=this.rules.heading.exec(t))t=t.substring(o[0].length),this.tokens.push({type:"heading",depth:o[1].length,text:o[2]});else if((o=this.rules.nptable.exec(t))&&(u={type:"table",header:b(o[1].replace(/^ *| *\| *$/g,"")),align:o[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:o[3]?o[3].replace(/\n$/,"").split("\n"):[]}).header.length===u.align.length){for(t=t.substring(o[0].length),p=0;p<u.align.length;p++)/^ *-+: *$/.test(u.align[p])?u.align[p]="right":/^ *:-+: *$/.test(u.align[p])?u.align[p]="center":/^ *:-+ *$/.test(u.align[p])?u.align[p]="left":u.align[p]=null;for(p=0;p<u.cells.length;p++)u.cells[p]=b(u.cells[p],u.header.length);this.tokens.push(u)}else if(o=this.rules.hr.exec(t))t=t.substring(o[0].length),this.tokens.push({type:"hr"});else if(o=this.rules.blockquote.exec(t))t=t.substring(o[0].length),this.tokens.push({type:"blockquote_start"}),o=o[0].replace(/^ *> ?/gm,""),this.token(o,e),this.tokens.push({type:"blockquote_end"});else if(o=this.rules.list.exec(t)){for(t=t.substring(o[0].length),c={type:"list_start",ordered:v=(s=o[2]).length>1,start:v?+s:"",loose:!1},this.tokens.push(c),l=[],r=!1,g=(o=o[0].match(this.rules.item)).length,p=0;p<g;p++)f=(u=o[p]).length,~(u=u.replace(/^ *([*+-]|\d+\.) */,"")).indexOf("\n ")&&(f-=u.length,u=this.options.pedantic?u.replace(/^ {1,4}/gm,""):u.replace(new RegExp("^ {1,"+f+"}","gm"),"")),p!==g-1&&(a=n.bullet.exec(o[p+1])[0],(s.length>1?1===a.length:a.length>1||this.options.smartLists&&a!==s)&&(t=o.slice(p+1).join("\n")+t,p=g-1)),i=r||/\n\n(?!\s*$)/.test(u),p!==g-1&&(r="\n"===u.charAt(u.length-1),i||(i=r)),i&&(c.loose=!0),w=void 0,(m=/^\[[ xX]\] /.test(u))&&(w=" "!==u[1],u=u.replace(/^\[[ xX]\] +/,"")),h={type:"list_item_start",task:m,checked:w,loose:i},l.push(h),this.tokens.push(h),this.token(u,!1),this.tokens.push({type:"list_item_end"});if(c.loose)for(g=l.length,p=0;p<g;p++)l[p].loose=!0;this.tokens.push({type:"list_end"})}else if(o=this.rules.html.exec(t))t=t.substring(o[0].length),this.tokens.push({type:this.options.sanitize?"paragraph":"html",pre:!this.options.sanitizer&&("pre"===o[1]||"script"===o[1]||"style"===o[1]),text:o[0]});else if(e&&(o=this.rules.def.exec(t)))t=t.substring(o[0].length),o[3]&&(o[3]=o[3].substring(1,o[3].length-1)),d=o[1].toLowerCase().replace(/\s+/g," "),this.tokens.links[d]||(this.tokens.links[d]={href:o[2],title:o[3]});else if((o=this.rules.table.exec(t))&&(u={type:"table",header:b(o[1].replace(/^ *| *\| *$/g,"")),align:o[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:o[3]?o[3].replace(/\n$/,"").split("\n"):[]}).header.length===u.align.length){for(t=t.substring(o[0].length),p=0;p<u.align.length;p++)/^ *-+: *$/.test(u.align[p])?u.align[p]="right":/^ *:-+: *$/.test(u.align[p])?u.align[p]="center":/^ *:-+ *$/.test(u.align[p])?u.align[p]="left":u.align[p]=null;for(p=0;p<u.cells.length;p++)u.cells[p]=b(u.cells[p].replace(/^ *\| *| *\| *$/g,""),u.header.length);this.tokens.push(u)}else if(o=this.rules.lheading.exec(t))t=t.substring(o[0].length),this.tokens.push({type:"heading",depth:"="===o[2]?1:2,text:o[1]});else if(e&&(o=this.rules.paragraph.exec(t)))t=t.substring(o[0].length),this.tokens.push({type:"paragraph",text:"\n"===o[1].charAt(o[1].length-1)?o[1].slice(0,-1):o[1]});else if(o=this.rules.text.exec(t))t=t.substring(o[0].length),this.tokens.push({type:"text",text:o[0]});else if(t)throw new Error("Infinite loop on byte: "+t.charCodeAt(0));return this.tokens};var i={escape:/^\\([!"#$%&'()*+,\-.\/:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:v,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(href(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(?!\s*\])((?:\\[\[\]]?|[^\[\]\\])+)\]/,nolink:/^!?\[(?!\s*\])((?:\[[^\[\]]*\]|\\[\[\]]|[^\[\]])*)\](?:\[\])?/,strong:/^__([^\s_])__(?!_)|^\*\*([^\s*])\*\*(?!\*)|^__([^\s][\s\S]*?[^\s])__(?!_)|^\*\*([^\s][\s\S]*?[^\s])\*\*(?!\*)/,em:/^_([^\s_])_(?!_)|^\*([^\s*"<\[])\*(?!\*)|^_([^\s][\s\S]*?[^\s_])_(?!_|[^\spunctuation])|^_([^\s_][\s\S]*?[^\s])_(?!_|[^\spunctuation])|^\*([^\s"<\[][\s\S]*?[^\s*])\*(?!\*)|^\*([^\s*"<\[][\s\S]*?[^\s])\*(?!\*)/,code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:v,text:/^(`+|[^`])(?:[\s\S]*?(?:(?=[\\<!\[`*]|\b_|$)|[^ ](?= {2,}\n))|(?= {2,}\n))/};function o(t,e){if(this.options=e||_.defaults,this.links=t,this.rules=i.normal,this.renderer=this.options.renderer||new s,this.renderer.options=this.options,!this.links)throw new Error("Tokens array requires a `links` property.");this.options.pedantic?this.rules=i.pedantic:this.options.gfm&&(this.options.breaks?this.rules=i.breaks:this.rules=i.gfm)}function s(t){this.options=t||_.defaults}function a(){}function u(t){this.tokens=[],this.token=null,this.options=t||_.defaults,this.options.renderer=this.options.renderer||new s,this.renderer=this.options.renderer,this.renderer.options=this.options,this.slugger=new c}function c(){this.seen={}}function l(t,e){if(e){if(l.escapeTest.test(t))return t.replace(l.escapeReplace,function(t){return l.replacements[t]})}else if(l.escapeTestNoEncode.test(t))return t.replace(l.escapeReplaceNoEncode,function(t){return l.replacements[t]});return t}function h(t){return t.replace(/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/gi,function(t,e){return"colon"===(e=e.toLowerCase())?":":"#"===e.charAt(0)?"x"===e.charAt(1)?String.fromCharCode(parseInt(e.substring(2),16)):String.fromCharCode(+e.substring(1)):""})}function f(t,e){return t=t.source||t,e=e||"",{replace:function(e,n){return n=(n=n.source||n).replace(/(^|[^\[])\^/g,"$1"),t=t.replace(e,n),this},getRegex:function(){return new RegExp(t,e)}}}function p(t,e,n){if(t){try{var r=decodeURIComponent(h(n)).replace(/[^\w:]/g,"").toLowerCase()}catch(t){return null}if(0===r.indexOf("javascript:")||0===r.indexOf("vbscript:")||0===r.indexOf("data:"))return null}e&&!g.test(n)&&(n=function(t,e){d[" "+t]||(/^[^:]+:\/*[^\/]*$/.test(t)?d[" "+t]=t+"/":d[" "+t]=y(t,"/",!0));return t=d[" "+t],"//"===e.slice(0,2)?t.replace(/:[\s\S]*/,":")+e:"/"===e.charAt(0)?t.replace(/(:\/*[^\/]*)[\s\S]*/,"$1")+e:t+e}(e,n));try{n=encodeURI(n).replace(/%25/g,"%")}catch(t){return null}return n}i._punctuation="!\"#$%&'()*+,\\-./:;<=>?@\\[^_{|}~",i.em=f(i.em).replace(/punctuation/g,i._punctuation).getRegex(),i._escapes=/\\([!"#$%&'()*+,\-.\/:;<=>?@\[\]\\^_`{|}~])/g,i._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/,i._email=/[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/,i.autolink=f(i.autolink).replace("scheme",i._scheme).replace("email",i._email).getRegex(),i._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/,i.tag=f(i.tag).replace("comment",n._comment).replace("attribute",i._attribute).getRegex(),i._label=/(?:\[[^\[\]]*\]|\\[\[\]]?|`[^`]*`|`(?!`)|[^\[\]\\`])*?/,i._href=/\s*(<(?:\\[<>]?|[^\s<>\\])*>|[^\s\x00-\x1f]*)/,i._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/,i.link=f(i.link).replace("label",i._label).replace("href",i._href).replace("title",i._title).getRegex(),i.reflink=f(i.reflink).replace("label",i._label).getRegex(),i.normal=m({},i),i.pedantic=m({},i.normal,{strong:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,em:/^_(?=\S)([\s\S]*?\S)_(?!_)|^\*(?=\S)([\s\S]*?\S)\*(?!\*)/,link:f(/^!?\[(label)\]\((.*?)\)/).replace("label",i._label).getRegex(),reflink:f(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",i._label).getRegex()}),i.gfm=m({},i.normal,{escape:f(i.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_~)]+(?!$))+/,del:/^~+(?=\S)([\s\S]*?\S)~+/,text:/^(`+|[^`])(?:[\s\S]*?(?:(?=[\\<!\[`*~]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@))|(?= {2,}\n|[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@))/}),i.gfm.url=f(i.gfm.url,"i").replace("email",i.gfm._extended_email).getRegex(),i.breaks=m({},i.gfm,{br:f(i.br).replace("{2,}","*").getRegex(),text:f(i.gfm.text).replace(/\{2,\}/g,"*").getRegex()}),o.rules=i,o.output=function(t,e,n){return new o(e,n).output(t)},o.prototype.output=function(t){for(var e,n,r,i,s,a,u="";t;)if(s=this.rules.escape.exec(t))t=t.substring(s[0].length),u+=l(s[1]);else if(s=this.rules.tag.exec(t))!this.inLink&&/^<a /i.test(s[0])?this.inLink=!0:this.inLink&&/^<\/a>/i.test(s[0])&&(this.inLink=!1),!this.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(s[0])?this.inRawBlock=!0:this.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(s[0])&&(this.inRawBlock=!1),t=t.substring(s[0].length),u+=this.options.sanitize?this.options.sanitizer?this.options.sanitizer(s[0]):l(s[0]):s[0];else if(s=this.rules.link.exec(t)){var c=w(s[2],"()");if(c>-1){var h=s[0].length-(s[2].length-c)-(s[3]||"").length;s[2]=s[2].substring(0,c),s[0]=s[0].substring(0,h).trim(),s[3]=""}t=t.substring(s[0].length),this.inLink=!0,r=s[2],this.options.pedantic?(e=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(r))?(r=e[1],i=e[3]):i="":i=s[3]?s[3].slice(1,-1):"",r=r.trim().replace(/^<([\s\S]*)>$/,"$1"),u+=this.outputLink(s,{href:o.escapes(r),title:o.escapes(i)}),this.inLink=!1}else if((s=this.rules.reflink.exec(t))||(s=this.rules.nolink.exec(t))){if(t=t.substring(s[0].length),e=(s[2]||s[1]).replace(/\s+/g," "),!(e=this.links[e.toLowerCase()])||!e.href){u+=s[0].charAt(0),t=s[0].substring(1)+t;continue}this.inLink=!0,u+=this.outputLink(s,e),this.inLink=!1}else if(s=this.rules.strong.exec(t))t=t.substring(s[0].length),u+=this.renderer.strong(this.output(s[4]||s[3]||s[2]||s[1]));else if(s=this.rules.em.exec(t))t=t.substring(s[0].length),u+=this.renderer.em(this.output(s[6]||s[5]||s[4]||s[3]||s[2]||s[1]));else if(s=this.rules.code.exec(t))t=t.substring(s[0].length),u+=this.renderer.codespan(l(s[2].trim(),!0));else if(s=this.rules.br.exec(t))t=t.substring(s[0].length),u+=this.renderer.br();else if(s=this.rules.del.exec(t))t=t.substring(s[0].length),u+=this.renderer.del(this.output(s[1]));else if(s=this.rules.autolink.exec(t))t=t.substring(s[0].length),r="@"===s[2]?"mailto:"+(n=l(this.mangle(s[1]))):n=l(s[1]),u+=this.renderer.link(r,null,n);else if(this.inLink||!(s=this.rules.url.exec(t))){if(s=this.rules.text.exec(t))t=t.substring(s[0].length),this.inRawBlock?u+=this.renderer.text(s[0]):u+=this.renderer.text(l(this.smartypants(s[0])));else if(t)throw new Error("Infinite loop on byte: "+t.charCodeAt(0))}else{if("@"===s[2])r="mailto:"+(n=l(s[0]));else{do{a=s[0],s[0]=this.rules._backpedal.exec(s[0])[0]}while(a!==s[0]);n=l(s[0]),r="www."===s[1]?"http://"+n:n}t=t.substring(s[0].length),u+=this.renderer.link(r,null,n)}return u},o.escapes=function(t){return t?t.replace(o.rules._escapes,"$1"):t},o.prototype.outputLink=function(t,e){var n=e.href,r=e.title?l(e.title):null;return"!"!==t[0].charAt(0)?this.renderer.link(n,r,this.output(t[1])):this.renderer.image(n,r,l(t[1]))},o.prototype.smartypants=function(t){return this.options.smartypants?t.replace(/---/g,"—").replace(/--/g,"–").replace(/(^|[-\u2014\/(\[{"\s])'/g,"$1‘").replace(/'/g,"’").replace(/(^|[-\u2014\/(\[{\u2018\s])"/g,"$1“").replace(/"/g,"”").replace(/\.{3}/g,"…"):t},o.prototype.mangle=function(t){if(!this.options.mangle)return t;for(var e,n="",r=t.length,i=0;i<r;i++)e=t.charCodeAt(i),Math.random()>.5&&(e="x"+e.toString(16)),n+="&#"+e+";";return n},s.prototype.code=function(t,e,n){var r=(e||"").match(/\S*/)[0];if(this.options.highlight){var i=this.options.highlight(t,r);null!=i&&i!==t&&(n=!0,t=i)}return r?'<pre><code class="'+this.options.langPrefix+l(r,!0)+'">'+(n?t:l(t,!0))+"</code></pre>\n":"<pre><code>"+(n?t:l(t,!0))+"</code></pre>"},s.prototype.blockquote=function(t){return"<blockquote>\n"+t+"</blockquote>\n"},s.prototype.html=function(t){return t},s.prototype.heading=function(t,e,n,r){return this.options.headerIds?"<h"+e+' id="'+this.options.headerPrefix+r.slug(n)+'">'+t+"</h"+e+">\n":"<h"+e+">"+t+"</h"+e+">\n"},s.prototype.hr=function(){return this.options.xhtml?"<hr/>\n":"<hr>\n"},s.prototype.list=function(t,e,n){var r=e?"ol":"ul";return"<"+r+(e&&1!==n?' start="'+n+'"':"")+">\n"+t+"</"+r+">\n"},s.prototype.listitem=function(t){return"<li>"+t+"</li>\n"},s.prototype.checkbox=function(t){return"<input "+(t?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> "},s.prototype.paragraph=function(t){return"<p>"+t+"</p>\n"},s.prototype.table=function(t,e){return e&&(e="<tbody>"+e+"</tbody>"),"<table>\n<thead>\n"+t+"</thead>\n"+e+"</table>\n"},s.prototype.tablerow=function(t){return"<tr>\n"+t+"</tr>\n"},s.prototype.tablecell=function(t,e){var n=e.header?"th":"td";return(e.align?"<"+n+' align="'+e.align+'">':"<"+n+">")+t+"</"+n+">\n"},s.prototype.strong=function(t){return"<strong>"+t+"</strong>"},s.prototype.em=function(t){return"<em>"+t+"</em>"},s.prototype.codespan=function(t){return"<code>"+t+"</code>"},s.prototype.br=function(){return this.options.xhtml?"<br/>":"<br>"},s.prototype.del=function(t){return"<del>"+t+"</del>"},s.prototype.link=function(t,e,n){if(null===(t=p(this.options.sanitize,this.options.baseUrl,t)))return n;var r='<a href="'+l(t)+'"';return e&&(r+=' title="'+e+'"'),r+=">"+n+"</a>"},s.prototype.image=function(t,e,n){if(null===(t=p(this.options.sanitize,this.options.baseUrl,t)))return n;var r='<img src="'+t+'" alt="'+n+'"';return e&&(r+=' title="'+e+'"'),r+=this.options.xhtml?"/>":">"},s.prototype.text=function(t){return t},a.prototype.strong=a.prototype.em=a.prototype.codespan=a.prototype.del=a.prototype.text=function(t){return t},a.prototype.link=a.prototype.image=function(t,e,n){return""+n},a.prototype.br=function(){return""},u.parse=function(t,e){return new u(e).parse(t)},u.prototype.parse=function(t){this.inline=new o(t.links,this.options),this.inlineText=new o(t.links,m({},this.options,{renderer:new a})),this.tokens=t.reverse();for(var e="";this.next();)e+=this.tok();return e},u.prototype.next=function(){return this.token=this.tokens.pop()},u.prototype.peek=function(){return this.tokens[this.tokens.length-1]||0},u.prototype.parseText=function(){for(var t=this.token.text;"text"===this.peek().type;)t+="\n"+this.next().text;return this.inline.output(t)},u.prototype.tok=function(){switch(this.token.type){case"space":return"";case"hr":return this.renderer.hr();case"heading":return this.renderer.heading(this.inline.output(this.token.text),this.token.depth,h(this.inlineText.output(this.token.text)),this.slugger);case"code":return this.renderer.code(this.token.text,this.token.lang,this.token.escaped);case"table":var t,e,n,r,i="",o="";for(n="",t=0;t<this.token.header.length;t++)n+=this.renderer.tablecell(this.inline.output(this.token.header[t]),{header:!0,align:this.token.align[t]});for(i+=this.renderer.tablerow(n),t=0;t<this.token.cells.length;t++){for(e=this.token.cells[t],n="",r=0;r<e.length;r++)n+=this.renderer.tablecell(this.inline.output(e[r]),{header:!1,align:this.token.align[r]});o+=this.renderer.tablerow(n)}return this.renderer.table(i,o);case"blockquote_start":for(o="";"blockquote_end"!==this.next().type;)o+=this.tok();return this.renderer.blockquote(o);case"list_start":o="";for(var s=this.token.ordered,a=this.token.start;"list_end"!==this.next().type;)o+=this.tok();return this.renderer.list(o,s,a);case"list_item_start":o="";var u=this.token.loose,c=this.token.checked,l=this.token.task;for(this.token.task&&(o+=this.renderer.checkbox(c));"list_item_end"!==this.next().type;)o+=u||"text"!==this.token.type?this.tok():this.parseText();return this.renderer.listitem(o,l,c);case"html":return this.renderer.html(this.token.text);case"paragraph":return this.renderer.paragraph(this.inline.output(this.token.text));case"text":return this.renderer.paragraph(this.parseText());default:var f='Token with "'+this.token.type+'" type was not found.';if(!this.options.silent)throw new Error(f);console.log(f)}},c.prototype.slug=function(t){var e=t.toLowerCase().trim().replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,.\/:;<=>?@[\]^`{|}~]/g,"").replace(/\s/g,"-");if(this.seen.hasOwnProperty(e)){var n=e;do{this.seen[n]++,e=n+"-"+this.seen[n]}while(this.seen.hasOwnProperty(e))}return this.seen[e]=0,e},l.escapeTest=/[&<>"']/,l.escapeReplace=/[&<>"']/g,l.replacements={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},l.escapeTestNoEncode=/[<>"']|&(?!#?\w+;)/,l.escapeReplaceNoEncode=/[<>"']|&(?!#?\w+;)/g;var d={},g=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;function v(){}function m(t){for(var e,n,r=1;r<arguments.length;r++)for(n in e=arguments[r])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}function b(t,e){var n=t.replace(/\|/g,function(t,e,n){for(var r=!1,i=e;--i>=0&&"\\"===n[i];)r=!r;return r?"|":" |"}).split(/ \|/),r=0;if(n.length>e)n.splice(e);else for(;n.length<e;)n.push("");for(;r<n.length;r++)n[r]=n[r].trim().replace(/\\\|/g,"|");return n}function y(t,e,n){if(0===t.length)return"";for(var r=0;r<t.length;){var i=t.charAt(t.length-r-1);if(i!==e||n){if(i===e||!n)break;r++}else r++}return t.substr(0,t.length-r)}function w(t,e){if(-1===t.indexOf(e[1]))return-1;for(var n=0,r=0;r<t.length;r++)if("\\"===t[r])r++;else if(t[r]===e[0])n++;else if(t[r]===e[1]&&--n<0)return r;return-1}function _(t,e,n){if(null==t)throw new Error("marked(): input parameter is undefined or null");if("string"!=typeof t)throw new Error("marked(): input parameter is of type "+Object.prototype.toString.call(t)+", string expected");if(n||"function"==typeof e){n||(n=e,e=null);var i,o,s=(e=m({},_.defaults,e||{})).highlight,a=0;try{i=r.lex(t,e)}catch(t){return n(t)}o=i.length;var c=function(t){if(t)return e.highlight=s,n(t);var r;try{r=u.parse(i,e)}catch(e){t=e}return e.highlight=s,t?n(t):n(null,r)};if(!s||s.length<3)return c();if(delete e.highlight,!o)return c();for(;a<i.length;a++)!function(t){"code"!==t.type?--o||c():s(t.text,t.lang,function(e,n){return e?c(e):null==n||n===t.text?--o||c():(t.text=n,t.escaped=!0,void(--o||c()))})}(i[a])}else try{return e&&(e=m({},_.defaults,e)),u.parse(r.lex(t,e),e)}catch(t){if(t.message+="\nPlease report this to https://github.com/markedjs/marked.",(e||_.defaults).silent)return"<p>An error occurred:</p><pre>"+l(t.message+"",!0)+"</pre>";throw t}}v.exec=v,_.options=_.setOptions=function(t){return m(_.defaults,t),_},_.getDefaults=function(){return{baseUrl:null,breaks:!1,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:new s,sanitize:!1,sanitizer:null,silent:!1,smartLists:!1,smartypants:!1,tables:!0,xhtml:!1}},_.defaults=_.getDefaults(),_.Parser=u,_.parser=u.parse,_.Renderer=s,_.TextRenderer=a,_.Lexer=r,_.lexer=r.lex,_.InlineLexer=o,_.inlineLexer=o.output,_.Slugger=c,_.parse=_,t.exports=_}(this||("undefined"!=typeof window?window:global))},GFNa:function(t,e,n){},HteQ:function(t,e){t.exports=require("preact")},OvAo:function(t,e,n){},QfWi:function(t,e,n){"use strict";n.r(e);n("GFNa"),n("2zjJ"),n("6jwM"),n("OvAo");var r=n("8Jek"),i=n.n(r),o=n("HteQ"),s={};function a(t,e){for(var n in e)t[n]=e[n];return t}function u(t,e){return t.rank<e.rank?1:t.rank>e.rank?-1:t.index-e.index}function c(t,e){return t.index=e,t.rank=function(t){return t.attributes.default?0:(e=t.attributes.path,l(e).map(h).join(""));var e}(t),t.attributes}function l(t){return t.replace(/(^\/+|\/+$)/g,"").split("/")}function h(t){return":"==t.charAt(0)?1+"*+?".indexOf(t.charAt(t.length-1))||4:5}var f=null,p=[],d=[],g={};function v(){var t;return""+((t=f&&f.location?f.location:f&&f.getCurrentLocation?f.getCurrentLocation():"undefined"!=typeof location?location:g).pathname||"")+(t.search||"")}function m(t,e){return void 0===e&&(e=!1),"string"!=typeof t&&t.url&&(e=t.replace,t=t.url),function(t){for(var e=p.length;e--;)if(p[e].canRoute(t))return!0;return!1}(t)&&function(t,e){void 0===e&&(e="push"),f&&f[e]?f[e](t):"undefined"!=typeof history&&history[e+"State"]&&history[e+"State"](null,null,t)}(t,e?"replace":"push"),b(t)}function b(t){for(var e=!1,n=0;n<p.length;n++)!0===p[n].routeTo(t)&&(e=!0);for(var r=d.length;r--;)d[r](t);return e}function y(t){if(t&&t.getAttribute){var e=t.getAttribute("href"),n=t.getAttribute("target");if(e&&e.match(/^\//g)&&(!n||n.match(/^_?self$/i)))return m(e)}}function w(t){if(0==t.button)return y(t.currentTarget||t.target||this),_(t)}function _(t){return t&&(t.stopImmediatePropagation&&t.stopImmediatePropagation(),t.stopPropagation&&t.stopPropagation(),t.preventDefault()),!1}function x(t){if(!(t.ctrlKey||t.metaKey||t.altKey||t.shiftKey||0!==t.button)){var e,n=t.target;do{if("A"===String(n.nodeName).toUpperCase()&&n.getAttribute("href")&&(null!=(e=n).__preactattr_||"undefined"!=typeof Symbol&&null!=e[Symbol.for("preactattr")])){if(n.hasAttribute("native"))return;if(y(n))return _(t)}}while(n=n.parentNode)}}var k=!1;var O=function(t){function e(e){t.call(this,e),e.history&&(f=e.history),this.state={url:e.url||v()},k||("function"==typeof addEventListener&&(f||addEventListener("popstate",function(){b(v())}),addEventListener("click",x)),k=!0)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.shouldComponentUpdate=function(t){return!0!==t.static||(t.url!==this.props.url||t.onChange!==this.props.onChange)},e.prototype.canRoute=function(t){return this.getMatchingChildren(this.props.children,t,!1).length>0},e.prototype.routeTo=function(t){return this._didRoute=!1,this.setState({url:t}),this.updating?this.canRoute(t):(this.forceUpdate(),this._didRoute)},e.prototype.componentWillMount=function(){p.push(this),this.updating=!0},e.prototype.componentDidMount=function(){var t=this;f&&(this.unlisten=f.listen(function(e){t.routeTo(""+(e.pathname||"")+(e.search||""))})),this.updating=!1},e.prototype.componentWillUnmount=function(){"function"==typeof this.unlisten&&this.unlisten(),p.splice(p.indexOf(this),1)},e.prototype.componentWillUpdate=function(){this.updating=!0},e.prototype.componentDidUpdate=function(){this.updating=!1},e.prototype.getMatchingChildren=function(t,e,n){return t.filter(c).sort(u).map(function(t){var r=function(t,e,n){var r,i=/(?:\?([^#]*))?(#.*)?$/,o=t.match(i),a={};if(o&&o[1])for(var u=o[1].split("&"),c=0;c<u.length;c++){var h=u[c].split("=");a[decodeURIComponent(h[0])]=decodeURIComponent(h.slice(1).join("="))}t=l(t.replace(i,"")),e=l(e||"");for(var f=Math.max(t.length,e.length),p=0;p<f;p++)if(e[p]&&":"===e[p].charAt(0)){var d=e[p].replace(/(^\:|[+*?]+$)/g,""),g=(e[p].match(/[+*?]+$/)||s)[0]||"",v=~g.indexOf("+"),m=~g.indexOf("*"),b=t[p]||"";if(!b&&!m&&(g.indexOf("?")<0||v)){r=!1;break}if(a[d]=decodeURIComponent(b),v||m){a[d]=t.slice(p).map(decodeURIComponent).join("/");break}}else if(e[p]!==t[p]){r=!1;break}return(!0===n.default||!1!==r)&&a}(e,t.attributes.path,t.attributes);if(r){if(!1!==n){var i={url:e,matches:r};return a(i,r),delete i.ref,delete i.key,Object(o.cloneElement)(t,i)}return t}}).filter(Boolean)},e.prototype.render=function(t,e){var n=t.children,r=t.onChange,i=e.url,o=this.getMatchingChildren(n,i,!0),s=o[0]||null;this._didRoute=!!s;var a=this.previousUrl;return i!==a&&(this.previousUrl=i,"function"==typeof r&&r({router:this,url:i,previous:a,active:o,current:s})),s},e}(o.Component),S=function(t){return Object(o.h)("a",a({onClick:w},t))};O.subscribers=d,O.getCurrentUrl=v,O.route=m,O.Router=O,O.Route=function(t){return Object(o.h)(t.component,t)},O.Link=S;var j={DRAFT_SAVE_TIMEOUT:4e3,SYNC_SERVER_URL:"",CLIENT_KEY:"",QUEUE_LIMIT:99,URL_PREFIX:"/fhmp"},E=j;var A=n("fh8t"),C=n.n(A);var I=function(t){var e,n;function r(e){var n;return(n=t.call(this,e)||this).toggleBurger=function(){return n.setState({isMenuActive:!n.state.isMenuActive})},n.state={isMenuActive:!1},n}return n=t,(e=r).prototype=Object.create(n.prototype),e.prototype.constructor=e,e.__proto__=n,r.prototype.render=function(){var t=i()({"is-active":this.state.isMenuActive});return Object(o.h)("nav",{class:"navbar has-shadow is-fixed-top",role:"navigation","aria-label":"main navigation"},Object(o.h)("div",{class:"navbar-brand"},Object(o.h)("div",{class:"navbar-item"},"FHMP"),Object(o.h)("a",{class:i()("navbar-burger burger",t),role:"button","aria-label":"menu","aria-expanded":"false",onClick:this.toggleBurger},Object(o.h)("span",{"aria-hidden":"true"}),Object(o.h)("span",{"aria-hidden":"true"}),Object(o.h)("span",{"aria-hidden":"true"}))),Object(o.h)("div",{class:i()("navbar-menu",t)},Object(o.h)("div",{class:"navbar-start"},Object(o.h)(R,{url:"/new",icon:"fas fa-seedling",text:"Add Note"}),Object(o.h)(R,{url:"/list",icon:"fas fa-list",text:"List"}),Object(o.h)(R,{url:"/review",icon:"fas fa-bong",text:"Review"}),Object(o.h)(R,{url:"/config",icon:"fas fa-cog",text:"Config"}),Object(o.h)(R,{url:"/sync",icon:"fas fa-sync",text:"Sync"}))))},r}(o.Component),R=function(t){var e=window.location.pathname.startsWith(t.url);return Object(o.h)(S,{class:i()("navbar-item",{"is-active":e}),href:E.URL_PREFIX+t.url},Object(o.h)("span",{class:"icon"},Object(o.h)("i",{class:t.icon})),Object(o.h)("span",null,t.text))};var P=function(t){var e,n;function r(e){var n;return(n=t.call(this,e)||this).message=function(t){t.error?console.error(t):t.warning&&console.warn(t),n.setState({message:t})},n.success=function(t){return function(){return n.message({success:!0,msg:t})}},n.warning=function(t){return function(e){return n.message({warning:!0,err:e,msg:t})}},n.error=function(t){return function(e){return n.message({error:!0,err:e,msg:t})}},n.clearMessage=function(){return n.setState({message:null})},n.state={message:null},n}return n=t,(e=r).prototype=Object.create(n.prototype),e.prototype.constructor=e,e.__proto__=n,r.prototype.render=function(){var t=this.state.message;return Object(o.h)("div",null,Object(o.h)(I,null),Object(o.h)("div",{class:i()("section",this.props.class)},this.props.children),t&&Object(o.h)("div",{class:"modal is-active"},Object(o.h)("div",{class:"modal-background",onClick:this.clearMessage}),Object(o.h)("div",{class:"modal-content",onClick:this.clearMessage},Object(o.h)("article",{class:i()("message",{"is-danger":t.error,"is-warning":t.warning,"is-success":t.success})},Object(o.h)("div",{class:"message-body"},t.msg)))))},r}(o.Component);function D(t){return Object(o.h)("span",{class:i()("button edit-btn is-small",t.class),onClick:function(){return m(E.URL_PREFIX+"/edit/"+t.noteId)}},Object(o.h)("i",{class:"fas fa-edit"}))}var T=function(t){var e,n;function r(e){var n;return(n=t.call(this,e)||this).showAnswer=function(){return n.setState({isAnswerVisible:!0})},n.skip=function(){return n.setState({isAnswerVisible:!1,queue:n.state.queue.slice(1)})},n.review=function(t){return n.props.db.addReview(n.state.queue[0],t).then(n.skip).catch(n.page.warning("Failed to save your review"))},n.hard=function(){return n.review("hard")},n.easy=function(){return n.review("easy")},n.state={queue:null,isAnswerVisible:!1},n}n=t,(e=r).prototype=Object.create(n.prototype),e.prototype.constructor=e,e.__proto__=n;var i=r.prototype;return i.componentDidMount=function(){var t=this;this.props.db.getNotesToReview().then(function(e){return t.setState({queue:e})}).catch(this.page.error(Object(o.h)("span",null,"We failed to fetch notes for review. ",Object(o.h)("br",null))))},i.render=function(){var t=this,e=this.state,n=e.queue,r=e.isAnswerVisible;if(null===n)return Object(o.h)("div",{class:"section"},"Fetching notes to review…");if(0===n.length)return Object(o.h)("div",{class:"section"},"Nothing to review. Well done!");var i=n[0].id,s=n[0].text.split(/\n-{4,}\n/),a=s[0],u=s[1];return Object(o.h)(P,{ref:function(e){return t.page=e}},Object(o.h)("div",{class:"edit-btn-container"},Object(o.h)(D,{noteId:i})),Object(o.h)("div",{class:"content"},Object(o.h)(C.a,{markdown:a})),!r&&Object(o.h)("div",{class:"field"},Object(o.h)("button",{class:"button is-light is-fullwidth",onClick:this.showAnswer},"Show the answer")),r&&Object(o.h)("div",{class:"content"},Object(o.h)(C.a,{markdown:u})),Object(o.h)("nav",{class:"navbar is-light is-fixed-bottom"},Object(o.h)("div",{class:"navbar-brand"},Object(o.h)(N,{text:"Hard",onClick:this.hard}),Object(o.h)(N,{text:"Skip",onClick:this.skip}),Object(o.h)(N,{text:"Easy",onClick:this.easy}))))},r}(o.Component);function N(t){var e=t.text,n=t.onClick;return Object(o.h)("a",{class:"navbar-item is-expanded",onClick:n},e)}var M=function(t){var e,n;function r(e){var n;return(n=t.call(this,e)||this).state={notes:[]},n}n=t,(e=r).prototype=Object.create(n.prototype),e.prototype.constructor=e,e.__proto__=n;var i=r.prototype;return i.componentDidMount=function(){var t=this,e=function(t){var e=t.text.split(/\n-{4,}\n/);return{question:e[0],answer:e[1],id:t.id}};this.props.db.getNotes().then(function(n){return t.setState({notes:n.map(e)})}).catch(this.page.error("Failed to load notes from local storage."))},i.render=function(){var t=this;return Object(o.h)(P,{ref:function(e){return t.page=e}},this.state.notes.map(function(t){return Object(o.h)("article",{class:"notification edit-btn-container"},t.question,Object(o.h)(D,{class:"is-light",noteId:t.id}))}))},r}(o.Component);var L=function(t){var e,n;function r(e){var n;return(n=t.call(this,e)||this).loadSavedNote=function(){return n.props.noteId?n.props.db.getNote(n.props.noteId).then(function(t){return n.setState({draft:null,text:t?t.text:""})}):n.setState({draft:null,text:""})},n.dismissDraftMsg=function(){return n.setState({draft:null})},n.onText=function(t){return n.setState({text:t.target.value,draftSaved:!1})},n.onSave=function(){var t=n.state.text;(n.props.noteId?function(){return n.props.db.updateNote(n.props.noteId,t)}:function(){return n.props.db.createNote(t)})().then(function(){n.props.db.dropDraft(n.props.noteId),n.setState({draftSaved:!0,text:""}),n.page.success("Your note was saved successfully.")()}).catch(n.page.error(Object(o.h)("span",null,"Sorry! ",Object(o.h)("br",null),"We could not save your note to the local storage.")))},n.state={text:"",draft:null,draftSaved:!0},n}n=t,(e=r).prototype=Object.create(n.prototype),e.prototype.constructor=e,e.__proto__=n;var s=r.prototype;return s.componentDidMount=function(){var t=this,e=this.props.noteId;this.props.db.getDraft(e).then(function(e){return e.text.length>10?t.setState({text:e.text,draft:e,draftSaved:!0}):t.loadSavedNote()}).catch(this.loadSavedNote),this.draftSaveLoop=setInterval(function(){return t.state.draftSaved||t.props.db.saveDraft(e,t.state.text).then(function(){return t.setState({draftSaved:!0})})},E.DRAFT_SAVE_TIMEOUT)},s.componentWillUnmount=function(){clearInterval(this.draftSaveLoop),this.props.db.saveDraft(this.props.noteId,this.state.text).catch(this.page.warning("Failed to save the draft"))},s.render=function(){var t=this,e=i()("textarea has-extra-height",{"is-success":this.state.draftSaved});return Object(o.h)(P,{ref:function(e){return t.page=e}},Object(o.h)("div",{class:"field"},this.state.draft&&Object(o.h)("article",{class:"message is-warning"},Object(o.h)("div",null,"Found draft saved on ",this.state.draft.time,Object(o.h)("button",{class:"button is-light",onClick:this.loadSavedNote},"Drop it"),Object(o.h)("button",{class:"button is-light",onClick:this.dismissDraftMsg},"Keep it"))),Object(o.h)("textarea",{class:e,ref:function(e){return t.textarea=e},onInput:this.onText,value:this.state.text,autofocus:"true"})),Object(o.h)("nav",{class:"navbar is-light is-fixed-bottom"},Object(o.h)("div",{class:"navbar-brand"},Object(o.h)("a",{class:"navbar-item is-expanded has-text-centered",disabled:!this.state.text,onClick:this.onSave},"Save"))))},r}(o.Component);function F(){return(F=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}var U=function(t){var e,n;function r(e){var n;return(n=t.call(this,e)||this).defaultState=function(){return F({},E)},n.onCancel=function(){return n.setState(n.defaultState())},n.onSave=function(){return(t=n.props.db,e=n.state,t.saveConfig(e).then(function(){for(var t in j)t in e&&(j[t]=e[t])})).then(n.page.success("Config was sucessfully saved to storage.")).catch(n.page.error("Failed to save config to storage."));var t,e},n.isValidNumber=function(t){return null===String(t).match(/^\d+$/)?"Should be positive number":null},n.setTimeout=function(t){return n.setState({DRAFT_SAVE_TIMEOUT:t.target.value})},n.setURL=function(t){return n.setState({SYNC_SERVER_URL:t.target.value})},n.setKey=function(t){return n.setState({CLIENT_KEY:t.target.value})},n.setQLimit=function(t){return n.setState({QUEUE_LIMIT:t.target.value})},n.state=n.defaultState(),n}return n=t,(e=r).prototype=Object.create(n.prototype),e.prototype.constructor=e,e.__proto__=n,r.prototype.render=function(){var t=this;return Object(o.h)(P,{ref:function(e){return t.page=e}},Object(o.h)($,{autofocus:"true",name:"Draft save timeout (in µseconds)",value:this.state.DRAFT_SAVE_TIMEOUT,valid:this.isValidNumber,onInput:this.setTimeout}),Object(o.h)($,{name:"Review queue size limit",value:this.state.QUEUE_LIMIT,onInput:this.setQLimit}),Object(o.h)($,{name:"Sync server URL",value:this.state.SYNC_SERVER_URL,onInput:this.setURL}),Object(o.h)($,{name:"Client key",value:this.state.CLIENT_KEY,onInput:this.setKey}),Object(o.h)("nav",{class:"navbar is-light is-fixed-bottom"},Object(o.h)("div",{class:"navbar-brand"},Object(o.h)("a",{class:"navbar-item is-expanded has-text-centered",onClick:this.onCancel},"Cancel"),Object(o.h)("a",{class:"navbar-item is-expanded has-text-centered",onClick:this.onSave},"Save"))))},r}(o.Component);function $(t){var e=t.name,n=t.value,r=t.valid,s=t.onInput,a=t.autofocus,u=r&&r(n);return Object(o.h)("div",{class:"field"},Object(o.h)("label",{class:"label"},e),Object(o.h)("div",{class:"control"},Object(o.h)("input",{class:i()("input",{"is-danger":u}),value:n,onInput:s,autofocus:a})),Object(o.h)("p",{class:i()("help",{"is-danger":u})},u))}var K=function(t){var e,n;function r(e){var n;return(n=t.call(this,e)||this).state={log:[]},n}n=t,(e=r).prototype=Object.create(n.prototype),e.prototype.constructor=e,e.__proto__=n;var i=r.prototype;return i.componentDidMount=function(){var t=this,e=function(e){return t.setState({log:t.state.log.concat(e)})};if(E.SYNC_SERVER_URL){e("Sync started");var n=this.props.db;n.pushToServer().then(function(){return e("  - data sent"),n.pullFromServer()}).then(function(t){return e("  - data received")}).catch(function(t){return e("Sync failed\n   - "+t)})}else e("Sync server is not defined in config.")},i.render=function(){return Object(o.h)(P,null,Object(o.h)("pre",null,this.state.log.join("\n")))},r}(o.Component),B=Object.keys,q=Array.isArray,z="undefined"!=typeof self?self:"undefined"!=typeof window?window:global;function V(t,e){return"object"!=typeof e?t:(B(e).forEach(function(n){t[n]=e[n]}),t)}var Z=Object.getPrototypeOf,W={}.hasOwnProperty;function Q(t,e){return W.call(t,e)}function H(t,e){"function"==typeof e&&(e=e(Z(t))),B(e).forEach(function(n){X(t,n,e[n])})}var Y=Object.defineProperty;function X(t,e,n,r){Y(t,e,V(n&&Q(n,"get")&&"function"==typeof n.get?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},r))}function J(t){return{from:function(e){return t.prototype=Object.create(e.prototype),X(t.prototype,"constructor",t),{extend:H.bind(null,t.prototype)}}}}var G=Object.getOwnPropertyDescriptor;var tt=[].slice;function et(t,e,n){return tt.call(t,e,n)}function nt(t,e){return e(t)}function rt(t){if(!t)throw new Error("Assertion Failed")}function it(t){z.setImmediate?setImmediate(t):setTimeout(t,0)}function ot(t,e){return t.reduce(function(t,n,r){var i=e(n,r);return i&&(t[i[0]]=i[1]),t},{})}function st(t,e){return function(){try{t.apply(this,arguments)}catch(t){e(t)}}}function at(t,e,n){try{t.apply(null,n)}catch(t){e&&e(t)}}function ut(t,e){if(Q(t,e))return t[e];if(!e)return t;if("string"!=typeof e){for(var n=[],r=0,i=e.length;r<i;++r){var o=ut(t,e[r]);n.push(o)}return n}var s=e.indexOf(".");if(-1!==s){var a=t[e.substr(0,s)];return void 0===a?void 0:ut(a,e.substr(s+1))}}function ct(t,e,n){if(t&&void 0!==e&&!("isFrozen"in Object&&Object.isFrozen(t)))if("string"!=typeof e&&"length"in e){rt("string"!=typeof n&&"length"in n);for(var r=0,i=e.length;r<i;++r)ct(t,e[r],n[r])}else{var o=e.indexOf(".");if(-1!==o){var s=e.substr(0,o),a=e.substr(o+1);if(""===a)void 0===n?delete t[s]:t[s]=n;else{var u=t[s];u||(u=t[s]={}),ct(u,a,n)}}else void 0===n?delete t[e]:t[e]=n}}function lt(t){var e={};for(var n in t)Q(t,n)&&(e[n]=t[n]);return e}var ht=[].concat;function ft(t){return ht.apply([],t)}var pt="Boolean,String,Date,RegExp,Blob,File,FileList,ArrayBuffer,DataView,Uint8ClampedArray,ImageData,Map,Set".split(",").concat(ft([8,16,32,64].map(function(t){return["Int","Uint","Float"].map(function(e){return e+t+"Array"})}))).filter(function(t){return z[t]}).map(function(t){return z[t]});function dt(t){if(!t||"object"!=typeof t)return t;var e;if(q(t)){e=[];for(var n=0,r=t.length;n<r;++n)e.push(dt(t[n]))}else if(pt.indexOf(t.constructor)>=0)e=t;else for(var i in e=t.constructor?Object.create(t.constructor.prototype):{},t)Q(t,i)&&(e[i]=dt(t[i]));return e}function gt(t,e,n,r){return n=n||{},r=r||"",B(t).forEach(function(i){if(Q(e,i)){var o=t[i],s=e[i];"object"==typeof o&&"object"==typeof s&&o&&s&&""+o.constructor==""+s.constructor?gt(o,s,n,r+i+"."):o!==s&&(n[r+i]=e[i])}else n[r+i]=void 0}),B(e).forEach(function(i){Q(t,i)||(n[r+i]=e[i])}),n}var vt="undefined"!=typeof Symbol&&Symbol.iterator,mt=vt?function(t){var e;return null!=t&&(e=t[vt])&&e.apply(t)}:function(){return null},bt={};function yt(t){var e,n,r,i;if(1===arguments.length){if(q(t))return t.slice();if(this===bt&&"string"==typeof t)return[t];if(i=mt(t)){for(n=[];!(r=i.next()).done;)n.push(r.value);return n}if(null==t)return[t];if("number"==typeof(e=t.length)){for(n=new Array(e);e--;)n[e]=t[e];return n}return[t]}for(e=arguments.length,n=new Array(e);e--;)n[e]=arguments[e];return n}var wt="undefined"!=typeof location&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function _t(t,e){wt=t,xt=e}var xt=function(){return!0},kt=!new Error("").stack;function Ot(){if(kt)try{throw Ot.arguments,new Error}catch(t){return t}return new Error}function St(t,e){var n=t.stack;return n?(e=e||0,0===n.indexOf(t.name)&&(e+=(t.name+t.message).split("\n").length),n.split("\n").slice(e).filter(xt).map(function(t){return"\n"+t}).join("")):""}var jt=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Et=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(jt),At={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed"};function Ct(t,e){this._e=Ot(),this.name=t,this.message=e}function It(t,e,n,r){this._e=Ot(),this.failures=e,this.failedKeys=r,this.successCount=n}function Rt(t,e){this._e=Ot(),this.name="BulkError",this.failures=e,this.message=function(t,e){return t+". Errors: "+e.map(function(t){return t.toString()}).filter(function(t,e,n){return n.indexOf(t)===e}).join("\n")}(t,e)}J(Ct).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+St(this._e,2))}},toString:function(){return this.name+": "+this.message}}),J(It).from(Ct),J(Rt).from(Ct);var Pt=Et.reduce(function(t,e){return t[e]=e+"Error",t},{}),Dt=Ct,Tt=Et.reduce(function(t,e){var n=e+"Error";function r(t,r){this._e=Ot(),this.name=n,t?"string"==typeof t?(this.message=t,this.inner=r||null):"object"==typeof t&&(this.message=t.name+" "+t.message,this.inner=t):(this.message=At[e]||n,this.inner=null)}return J(r).from(Dt),t[e]=r,t},{});Tt.Syntax=SyntaxError,Tt.Type=TypeError,Tt.Range=RangeError;var Nt=jt.reduce(function(t,e){return t[e+"Error"]=Tt[e],t},{});var Mt=Et.reduce(function(t,e){return-1===["Syntax","Type","Range"].indexOf(e)&&(t[e+"Error"]=Tt[e]),t},{});function Lt(){}function Ft(t){return t}function Ut(t,e){return null==t||t===Ft?e:function(n){return e(t(n))}}function $t(t,e){return function(){t.apply(this,arguments),e.apply(this,arguments)}}function Kt(t,e){return t===Lt?e:function(){var n=t.apply(this,arguments);void 0!==n&&(arguments[0]=n);var r=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var o=e.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?$t(r,this.onsuccess):r),i&&(this.onerror=this.onerror?$t(i,this.onerror):i),void 0!==o?o:n}}function Bt(t,e){return t===Lt?e:function(){t.apply(this,arguments);var n=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,e.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?$t(n,this.onsuccess):n),r&&(this.onerror=this.onerror?$t(r,this.onerror):r)}}function qt(t,e){return t===Lt?e:function(n){var r=t.apply(this,arguments);V(n,r);var i=this.onsuccess,o=this.onerror;this.onsuccess=null,this.onerror=null;var s=e.apply(this,arguments);return i&&(this.onsuccess=this.onsuccess?$t(i,this.onsuccess):i),o&&(this.onerror=this.onerror?$t(o,this.onerror):o),void 0===r?void 0===s?void 0:s:V(r,s)}}function zt(t,e){return t===Lt?e:function(){return!1!==e.apply(this,arguments)&&t.apply(this,arguments)}}function Vt(t,e){return t===Lt?e:function(){var n=t.apply(this,arguments);if(n&&"function"==typeof n.then){for(var r=this,i=arguments.length,o=new Array(i);i--;)o[i]=arguments[i];return n.then(function(){return e.apply(r,o)})}return e.apply(this,arguments)}}Mt.ModifyError=It,Mt.DexieError=Ct,Mt.BulkError=Rt;var Zt={},Wt=100,Qt=7,Ht=function(){try{return new Function("let F=async ()=>{},p=F();return [p,Object.getPrototypeOf(p),Promise.resolve(),F.constructor];")()}catch(e){var t=z.Promise;return t?[t.resolve(),t.prototype,t.resolve()]:[]}}(),Yt=Ht[0],Xt=Ht[1],Jt=Ht[2],Gt=Xt&&Xt.then,te=Yt&&Yt.constructor,ee=Ht[3],ne=!!Jt,re=!1,ie=Jt?function(){Jt.then(Se)}:z.setImmediate?setImmediate.bind(null,Se):z.MutationObserver?function(){var t=document.createElement("div");new MutationObserver(function(){Se(),t=null}).observe(t,{attributes:!0}),t.setAttribute("i","1")}:function(){setTimeout(Se,0)},oe=function(t,e){de.push([t,e]),ae&&(ie(),ae=!1)},se=!0,ae=!0,ue=[],ce=[],le=null,he=Ft,fe={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:Qe,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach(function(t){try{Qe(t[0],t[1])}catch(t){}})}},pe=fe,de=[],ge=0,ve=[];function me(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=Lt,this._lib=!1;var e=this._PSD=pe;if(wt&&(this._stackHolder=Ot(),this._prev=null,this._numPrev=0),"function"!=typeof t){if(t!==Zt)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(!1===this._state&&we(this,this._value))}this._state=null,this._value=null,++e.ref,function t(e,n){try{n(function(n){if(null===e._state){if(n===e)throw new TypeError("A promise cannot be resolved with itself.");var r=e._lib&&je();n&&"function"==typeof n.then?t(e,function(t,e){n instanceof me?n._then(t,e):n.then(t,e)}):(e._state=!0,e._value=n,_e(e)),r&&Ee()}},we.bind(null,e))}catch(t){we(e,t)}}(this,t)}var be={get:function(){var t=pe,e=Ne;function n(n,r){var i=this,o=!t.global&&(t!==pe||e!==Ne);o&&Ue();var s=new me(function(e,s){xe(i,new ye(Ve(n,t,o),Ve(r,t,o),e,s,t))});return wt&&Oe(s,this),s}return n.prototype=Zt,n},set:function(t){X(this,"then",t&&t.prototype===Zt?be:{get:function(){return t},set:be.set})}};function ye(t,e,n,r,i){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.resolve=n,this.reject=r,this.psd=i}function we(t,e){if(ce.push(e),null===t._state){var n=t._lib&&je();e=he(e),t._state=!1,t._value=e,wt&&null!==e&&"object"==typeof e&&!e._promise&&at(function(){var n=function t(e,n){var r;return G(e,n)||(r=Z(e))&&t(r,n)}(e,"stack");e._promise=t,X(e,"stack",{get:function(){return re?n&&(n.get?n.get.apply(e):n.value):t.stack}})}),function(t){ue.some(function(e){return e._value===t._value})||ue.push(t)}(t),_e(t),n&&Ee()}}function _e(t){var e=t._listeners;t._listeners=[];for(var n=0,r=e.length;n<r;++n)xe(t,e[n]);var i=t._PSD;--i.ref||i.finalize(),0===ge&&(++ge,oe(function(){0==--ge&&Ae()},[]))}function xe(t,e){if(null!==t._state){var n=t._state?e.onFulfilled:e.onRejected;if(null===n)return(t._state?e.resolve:e.reject)(t._value);++e.psd.ref,++ge,oe(ke,[n,t,e])}else t._listeners.push(e)}function ke(t,e,n){try{le=e;var r,i=e._value;e._state?r=t(i):(ce.length&&(ce=[]),r=t(i),-1===ce.indexOf(i)&&function(t){var e=ue.length;for(;e;)if(ue[--e]._value===t._value)return void ue.splice(e,1)}(e)),n.resolve(r)}catch(t){n.reject(t)}finally{le=null,0==--ge&&Ae(),--n.psd.ref||n.psd.finalize()}}function Oe(t,e){var n=e?e._numPrev+1:0;n<Wt&&(t._prev=e,t._numPrev=n)}function Se(){je()&&Ee()}function je(){var t=se;return se=!1,ae=!1,t}function Ee(){var t,e,n;do{for(;de.length>0;)for(t=de,de=[],n=t.length,e=0;e<n;++e){var r=t[e];r[0].apply(null,r[1])}}while(de.length>0);se=!0,ae=!0}function Ae(){var t=ue;ue=[],t.forEach(function(t){t._PSD.onunhandled.call(null,t._value,t)});for(var e=ve.slice(0),n=e.length;n;)e[--n]()}function Ce(t){return new me(Zt,!1,t)}function Ie(t,e){var n=pe;return function(){var r=je(),i=pe;try{return Be(n,!0),t.apply(this,arguments)}catch(t){e&&e(t)}finally{Be(i,!1),r&&Ee()}}}H(me.prototype,{then:be,_then:function(t,e){xe(this,new ye(null,null,t,e,pe))},catch:function(t){if(1===arguments.length)return this.then(null,t);var e=arguments[0],n=arguments[1];return"function"==typeof e?this.then(null,function(t){return t instanceof e?n(t):Ce(t)}):this.then(null,function(t){return t&&t.name===e?n(t):Ce(t)})},finally:function(t){return this.then(function(e){return t(),e},function(e){return t(),Ce(e)})},stack:{get:function(){if(this._stack)return this._stack;try{re=!0;var t=function t(e,n,r){if(n.length===r)return n;var i="";if(!1===e._state){var o,s,a=e._value;null!=a?(o=a.name||"Error",s=a.message||a,i=St(a,0)):(o=a,s=""),n.push(o+(s?": "+s:"")+i)}wt&&((i=St(e._stackHolder,2))&&-1===n.indexOf(i)&&n.push(i),e._prev&&t(e._prev,n,r));return n}(this,[],20).join("\nFrom previous: ");return null!==this._state&&(this._stack=t),t}finally{re=!1}}},timeout:function(t,e){var n=this;return t<1/0?new me(function(r,i){var o=setTimeout(function(){return i(new Tt.Timeout(e))},t);n.then(r,i).finally(clearTimeout.bind(null,o))}):this}}),"undefined"!=typeof Symbol&&Symbol.toStringTag&&X(me.prototype,Symbol.toStringTag,"Promise"),fe.env=qe(),H(me,{all:function(){var t=yt.apply(null,arguments).map($e);return new me(function(e,n){0===t.length&&e([]);var r=t.length;t.forEach(function(i,o){return me.resolve(i).then(function(n){t[o]=n,--r||e(t)},n)})})},resolve:function(t){if(t instanceof me)return t;if(t&&"function"==typeof t.then)return new me(function(e,n){t.then(e,n)});var e=new me(Zt,!0,t);return Oe(e,le),e},reject:Ce,race:function(){var t=yt.apply(null,arguments).map($e);return new me(function(e,n){t.map(function(t){return me.resolve(t).then(e,n)})})},PSD:{get:function(){return pe},set:function(t){return pe=t}},newPSD:Le,usePSD:ze,scheduler:{get:function(){return oe},set:function(t){oe=t}},rejectionMapper:{get:function(){return he},set:function(t){he=t}},follow:function(t,e){return new me(function(n,r){return Le(function(e,n){var r=pe;r.unhandleds=[],r.onunhandled=n,r.finalize=$t(function(){var t=this;!function(t){ve.push(function e(){t();ve.splice(ve.indexOf(e),1)}),++ge,oe(function(){0==--ge&&Ae()},[])}(function(){0===t.unhandleds.length?e():n(t.unhandleds[0])})},r.finalize),t()},e,n,r)})}});var Re={awaits:0,echoes:0,id:0},Pe=0,De=[],Te=0,Ne=0,Me=0;function Le(t,e,n,r){var i=pe,o=Object.create(i);o.parent=i,o.ref=0,o.global=!1,o.id=++Me;var s=fe.env;o.env=ne?{Promise:me,PromiseProp:{value:me,configurable:!0,writable:!0},all:me.all,race:me.race,resolve:me.resolve,reject:me.reject,nthen:Ze(s.nthen,o),gthen:Ze(s.gthen,o)}:{},e&&V(o,e),++i.ref,o.finalize=function(){--this.parent.ref||this.parent.finalize()};var a=ze(o,t,n,r);return 0===o.ref&&o.finalize(),a}function Fe(){return Re.id||(Re.id=++Pe),++Re.awaits,Re.echoes+=Qt,Re.id}function Ue(t){!Re.awaits||t&&t!==Re.id||(0==--Re.awaits&&(Re.id=0),Re.echoes=Re.awaits*Qt)}function $e(t){return Re.echoes&&t&&t.constructor===te?(Fe(),t.then(function(t){return Ue(),t},function(t){return Ue(),He(t)})):t}function Ke(){var t=De[De.length-1];De.pop(),Be(t,!1)}function Be(t,e){var n,r=pe;if((e?!Re.echoes||Te++&&t===pe:!Te||--Te&&t===pe)||(n=e?function(t){++Ne,Re.echoes&&0!=--Re.echoes||(Re.echoes=Re.id=0),De.push(pe),Be(t,!0)}.bind(null,t):Ke,Gt.call(Yt,n)),t!==pe&&(pe=t,r===fe&&(fe.env=qe()),ne)){var i=fe.env.Promise,o=t.env;Xt.then=o.nthen,i.prototype.then=o.gthen,(r.global||t.global)&&(Object.defineProperty(z,"Promise",o.PromiseProp),i.all=o.all,i.race=o.race,i.resolve=o.resolve,i.reject=o.reject)}}function qe(){var t=z.Promise;return ne?{Promise:t,PromiseProp:Object.getOwnPropertyDescriptor(z,"Promise"),all:t.all,race:t.race,resolve:t.resolve,reject:t.reject,nthen:Xt.then,gthen:t.prototype.then}:{}}function ze(t,e,n,r,i){var o=pe;try{return Be(t,!0),e(n,r,i)}finally{Be(o,!1)}}function Ve(t,e,n){return"function"!=typeof t?t:function(){var r=pe;n&&Fe(),Be(e,!0);try{return t.apply(this,arguments)}finally{Be(r,!1)}}}function Ze(t,e){return function(n,r){return t.call(this,Ve(n,e,!1),Ve(r,e,!1))}}var We="unhandledrejection";function Qe(t,e){var n;try{n=e.onuncatched(t)}catch(t){}if(!1!==n)try{var r,i={promise:e,reason:t};if(z.document&&document.createEvent?((r=document.createEvent("Event")).initEvent(We,!0,!0),V(r,i)):z.CustomEvent&&V(r=new CustomEvent(We,{detail:i}),i),r&&z.dispatchEvent&&(dispatchEvent(r),!z.PromiseRejectionEvent&&z.onunhandledrejection))try{z.onunhandledrejection(r)}catch(t){}r.defaultPrevented||console.warn("Unhandled rejection: "+(t.stack||t))}catch(t){}}var He=me.reject;function Ye(t){var e={},n=function(n,r){if(r){for(var i=arguments.length,o=new Array(i-1);--i;)o[i-1]=arguments[i];return e[n].subscribe.apply(null,o),t}if("string"==typeof n)return e[n]};n.addEventType=o;for(var r=1,i=arguments.length;r<i;++r)o(arguments[r]);return n;function o(t,r,i){if("object"!=typeof t){var s;r||(r=zt),i||(i=Lt);var a={subscribers:[],fire:i,subscribe:function(t){-1===a.subscribers.indexOf(t)&&(a.subscribers.push(t),a.fire=r(a.fire,t))},unsubscribe:function(t){a.subscribers=a.subscribers.filter(function(e){return e!==t}),a.fire=a.subscribers.reduce(r,i)}};return e[t]=n[t]=a,a}B(s=t).forEach(function(t){var e=s[t];if(q(e))o(t,s[t][0],s[t][1]);else{if("asap"!==e)throw new Tt.InvalidArgument("Invalid event config");var n=o(t,Ft,function(){for(var t=arguments.length,e=new Array(t);t--;)e[t]=arguments[t];n.subscribers.forEach(function(t){it(function(){t.apply(null,e)})})})}})}}var Xe,Je=String.fromCharCode(65535),Ge=function(){try{return IDBKeyRange.only([[]]),[[]]}catch(t){return Je}}(),tn=-1/0,en="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",nn="String expected.",rn=[],on="undefined"!=typeof navigator&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),sn=on,an=on,un=function(t){return!/(dexie\.js|dexie\.min\.js)/.test(t)};function cn(t,e){var n,r,i,o,s,a=cn.dependencies,u=V({addons:cn.addons,autoOpen:!0,indexedDB:a.indexedDB,IDBKeyRange:a.IDBKeyRange},e),c=u.addons,l=u.autoOpen,h=u.indexedDB,f=u.IDBKeyRange,p=this._dbSchema={},d=[],g=[],v={},m=null,b=null,y=!1,w=null,_=!1,x="readwrite",k=this,O=new me(function(t){n=t}),S=new me(function(t,e){r=e}),j=!0,E=!!wn(h);function A(t){this._cfg={version:t,storesSource:null,dbschema:{},tables:{},contentUpgrade:null},this.stores({})}function C(t,e,n){var r=k._createTransaction(x,g,p);r.create(e),r._completion.catch(n);var i=r._reject.bind(r);Le(function(){pe.trans=r,0===t?(B(p).forEach(function(t){I(e,t,p[t].primKey,p[t].indexes)}),me.follow(function(){return k.on.populate.fire(r)}).catch(i)):function(t,e,n){var r=[],i=d.filter(function(e){return e._cfg.version===t})[0];if(!i)throw new Tt.Upgrade("Dexie specification of currently installed DB version is missing");p=k._dbSchema=i._cfg.dbschema;var o=!1;return d.filter(function(e){return e._cfg.version>t}).forEach(function(t){r.push(function(){var r=p,i=t._cfg.dbschema;ht(r,n),ht(i,n),p=k._dbSchema=i;var s=function(t,e){var n={del:[],add:[],change:[]};for(var r in t)e[r]||n.del.push(r);for(r in e){var i=t[r],o=e[r];if(i){var s={name:r,def:o,recreate:!1,del:[],add:[],change:[]};if(i.primKey.src!==o.primKey.src)s.recreate=!0,n.change.push(s);else{var a=i.idxByName,u=o.idxByName;for(var c in a)u[c]||s.del.push(c);for(c in u){var l=a[c],h=u[c];l?l.src!==h.src&&s.change.push(h):s.add.push(h)}(s.del.length>0||s.add.length>0||s.change.length>0)&&n.change.push(s)}}else n.add.push([r,o])}return n}(r,i);if(s.add.forEach(function(t){I(n,t[0],t[1].primKey,t[1].indexes)}),s.change.forEach(function(t){if(t.recreate)throw new Tt.Upgrade("Not yet support for changing primary key");var e=n.objectStore(t.name);t.add.forEach(function(t){R(e,t)}),t.change.forEach(function(t){e.deleteIndex(t.name),R(e,t)}),t.del.forEach(function(t){e.deleteIndex(t)})}),t._cfg.contentUpgrade)return o=!0,me.follow(function(){t._cfg.contentUpgrade(e)})}),r.push(function(e){o&&sn||function(t,e){for(var n=0;n<e.db.objectStoreNames.length;++n){var r=e.db.objectStoreNames[n];null==t[r]&&e.db.deleteObjectStore(r)}}(t._cfg.dbschema,e)})}),function t(){return r.length?me.resolve(r.shift()(e.idbtrans)).then(t):me.resolve()}().then(function(){!function(t,e){B(t).forEach(function(n){e.db.objectStoreNames.contains(n)||I(e,n,t[n].primKey,t[n].indexes)})}(p,n)})}(t,r,e).catch(i)})}function I(t,e,n,r){var i=t.db.createObjectStore(e,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return r.forEach(function(t){R(i,t)}),i}function R(t,e){t.createIndex(e.name,e.keyPath,{unique:e.unique,multiEntry:e.multi})}function P(t,e,n){this.name=t,this.schema=e,this._tx=n,this.hook=v[t]?v[t].hook:Ye(null,{creating:[Kt,Lt],reading:[Ut,Ft],updating:[qt,Lt],deleting:[Bt,Lt]})}function D(t,e,n){return(n?dn:fn)(function(n){t.push(n),e&&e()})}function T(t,e,n,r,i){return new me(function(o,s){var a=n.length,u=a-1;if(0===a)return o();if(r){var c,l=dn(s),h=hn(null);at(function(){for(var r=0;r<a;++r){c={onsuccess:null,onerror:null};var s=n[r];i.call(c,s[0],s[1],e);var f=t.delete(s[0]);f._hookCtx=c,f.onerror=l,f.onsuccess=r===u?hn(o):h}},function(t){throw c.onerror&&c.onerror(t),t})}else for(var f=0;f<a;++f){var p=t.delete(n[f]);p.onerror=fn(s),f===u&&(p.onsuccess=Ie(function(){return o()}))}})}function N(t,e,n,r){var i=this;this.db=k,this.mode=t,this.storeNames=e,this.idbtrans=null,this.on=Ye(this,"complete","error","abort"),this.parent=r||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new me(function(t,e){i._resolve=t,i._reject=e}),this._completion.then(function(){i.active=!1,i.on.complete.fire()},function(t){var e=i.active;return i.active=!1,i.on.error.fire(t),i.parent?i.parent._reject(t):e&&i.idbtrans&&i.idbtrans.abort(),He(t)})}function M(t,e,n){this._ctx={table:t,index:":id"===e?null:e,or:n}}function L(t,e){var n=null,r=null;if(e)try{n=e()}catch(t){r=t}var i=t._ctx,o=i.table;this._ctx={table:o,index:i.index,isPrimKey:!i.index||o.schema.primKey.keyPath&&i.index===o.schema.primKey.name,range:n,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:r,or:i.or,valueMapper:o.hook.reading.fire}}function F(t,e){return!(t.filter||t.algorithm||t.or)&&(e?t.justLimit:!t.replayFilter)}function U(t,e){return t._cfg.version-e._cfg.version}function $(t,e,n){e.forEach(function(e){var r=n[e];t.forEach(function(t){e in t||(t===N.prototype||t instanceof N?X(t,e,{get:function(){return this.table(e)}}):t[e]=new P(e,r))})})}function K(t,e,n,r,i,o){var s=Ie(o?function(t,e,r){return n(o(t),e,r)}:n,i);t.onerror||(t.onerror=fn(i)),t.onsuccess=st(e?function(){var n=t.result;if(n){var o=function(){n.continue()};e(n,function(t){o=t},r,i)&&s(n.value,n,function(t){o=t}),o()}else r()}:function(){var e=t.result;if(e){var n=function(){e.continue()};s(e.value,e,function(t){n=t}),n()}else r()},i)}function Z(t,e){return h.cmp(t,e)}function W(t,e){return Z(t,e)>0?t:e}function Y(t,e){return h.cmp(t,e)}function J(t,e){return h.cmp(e,t)}function G(t,e){return t<e?-1:t===e?0:1}function tt(t,e){return t>e?-1:t===e?0:1}function it(t,e){return t?e?function(){return t.apply(this,arguments)&&e.apply(this,arguments)}:t:e}function ht(t,e){for(var n=e.db.objectStoreNames,r=0;r<n.length;++r){var o=n[r],s=e.objectStore(o);i="getAll"in s;for(var a=0;a<s.indexNames.length;++a){var u=s.indexNames[a],c=s.index(u).keyPath,l="string"==typeof c?c:"["+et(c).join("+")+"]";if(t[o]){var h=t[o].idxByName[l];h&&(h.name=u)}}}/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&z.WorkerGlobalScope&&z instanceof z.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(i=!1)}function pt(t){k.on("blocked").fire(t),rn.filter(function(t){return t.name===k.name&&t!==k&&!t._vcFired}).map(function(e){return e.on("versionchange").fire(t)})}this.version=function(t){if(m||y)throw new Tt.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,t);var e=d.filter(function(e){return e._cfg.version===t})[0];return e||(e=new A(t),d.push(e),d.sort(U),j=!1,e)},V(A.prototype,{stores:function(t){this._cfg.storesSource=this._cfg.storesSource?V(this._cfg.storesSource,t):t;var e={};d.forEach(function(t){V(e,t._cfg.storesSource)});var n=this._cfg.dbschema={};return this._parseStoresSpec(e,n),p=k._dbSchema=n,[v,k,N.prototype].forEach(function(t){for(var e in t)t[e]instanceof P&&delete t[e]}),$([v,k,N.prototype,this._cfg.tables],B(n),n),g=B(n),this},upgrade:function(t){return this._cfg.contentUpgrade=t,this},_parseStoresSpec:function(t,e){B(t).forEach(function(n){if(null!==t[n]){var r={},i=function(t){var e=[];return t.split(",").forEach(function(t){var n=(t=t.trim()).replace(/([&*]|\+\+)/g,""),r=/^\[/.test(n)?n.match(/^\[(.*)\]$/)[1].split("+"):n;e.push(new mn(n,r||null,/\&/.test(t),/\*/.test(t),/\+\+/.test(t),q(r),/\./.test(t)))}),e}(t[n]),o=i.shift();if(o.multi)throw new Tt.Schema("Primary key cannot be multi-valued");o.keyPath&&ct(r,o.keyPath,o.auto?0:o.keyPath),i.forEach(function(t){if(t.auto)throw new Tt.Schema("Only primary key can be marked as autoIncrement (++)");if(!t.keyPath)throw new Tt.Schema("Index must have a name and cannot be an empty string");ct(r,t.keyPath,t.compound?t.keyPath.map(function(){return""}):"")}),e[n]=new bn(n,o,i,r)}})}}),this._allTables=v,this._createTransaction=function(t,e,n,r){return new N(t,e,n,r)},this._whenReady=function(t){return _||pe.letThrough?t():new me(function(t,e){if(!y){if(!l)return void e(new Tt.DatabaseClosed);k.open().catch(Lt)}O.then(t,e)}).then(t)},this.verno=0,this.open=function(){if(y||m)return O.then(function(){return b?He(b):k});wt&&(S._stackHolder=Ot()),y=!0,b=null,_=!1;var e=n,r=null;return me.race([S,new me(function(e,n){if(!h)throw new Tt.MissingAPI("indexedDB API not found. If using IE10+, make sure to run your code on a server URL (not locally). If using old Safari versions, make sure to include indexedDB polyfill.");var i=j?h.open(t):h.open(t,Math.round(10*k.verno));if(!i)throw new Tt.MissingAPI("IndexedDB API not available");i.onerror=fn(n),i.onblocked=Ie(pt),i.onupgradeneeded=Ie(function(e){if(r=i.transaction,j&&!k._allowEmptyDB){i.onerror=gn,r.abort(),i.result.close();var o=h.deleteDatabase(t);o.onsuccess=o.onerror=Ie(function(){n(new Tt.NoSuchDatabase("Database "+t+" doesnt exist"))})}else{r.onerror=fn(n),C((e.oldVersion>Math.pow(2,62)?0:e.oldVersion)/10,r,n)}},n),i.onsuccess=Ie(function(){if(r=null,m=i.result,rn.push(k),j)!function(){if(k.verno=m.version/10,k._dbSchema=p={},0===(g=et(m.objectStoreNames,0)).length)return;var t=m.transaction(yn(g),"readonly");g.forEach(function(e){for(var n=t.objectStore(e),r=n.keyPath,i=r&&"string"==typeof r&&-1!==r.indexOf("."),o=new mn(r,r||"",!1,!1,!!n.autoIncrement,r&&"string"!=typeof r,i),s=[],a=0;a<n.indexNames.length;++a){var u=n.index(n.indexNames[a]);r=u.keyPath,i=r&&"string"==typeof r&&-1!==r.indexOf(".");var c=new mn(u.name,r,!!u.unique,!!u.multiEntry,!1,r&&"string"!=typeof r,i);s.push(c)}p[e]=new bn(e,o,s,{})}),$([v],B(p),p)}();else if(m.objectStoreNames.length>0)try{ht(p,m.transaction(yn(m.objectStoreNames),"readonly"))}catch(t){}m.onversionchange=Ie(function(t){k._vcFired=!0,k.on("versionchange").fire(t)}),E||"__dbnames"===t||Xe.dbnames.put({name:t}).catch(Lt),e()},n)})]).then(function(){return w=[],me.resolve(cn.vip(k.on.ready.fire)).then(function t(){if(w.length>0){var e=w.reduce(Vt,Lt);return w=[],me.resolve(cn.vip(e)).then(t)}})}).finally(function(){w=null}).then(function(){return y=!1,k}).catch(function(t){try{r&&r.abort()}catch(t){}return y=!1,k.close(),He(b=t)}).finally(function(){_=!0,e()})},this.close=function(){var t=rn.indexOf(k);if(t>=0&&rn.splice(t,1),m){try{m.close()}catch(t){}m=null}l=!1,b=new Tt.DatabaseClosed,y&&r(b),O=new me(function(t){n=t}),S=new me(function(t,e){r=e})},this.delete=function(){var e=arguments.length>0;return new me(function(n,r){if(e)throw new Tt.InvalidArgument("Arguments not allowed in db.delete()");function i(){k.close();var e=h.deleteDatabase(t);e.onsuccess=Ie(function(){E||Xe.dbnames.delete(t).catch(Lt),n()}),e.onerror=fn(r),e.onblocked=pt}y?O.then(i):i()})},this.backendDB=function(){return m},this.isOpen=function(){return null!==m},this.hasBeenClosed=function(){return b&&b instanceof Tt.DatabaseClosed},this.hasFailed=function(){return null!==b},this.dynamicallyOpened=function(){return j},this.name=t,H(this,{tables:{get:function(){return B(v).map(function(t){return v[t]})}}}),this.on=Ye(this,"populate","blocked","versionchange",{ready:[Vt,Lt]}),this.on.ready.subscribe=nt(this.on.ready.subscribe,function(t){return function(e,n){cn.vip(function(){_?(b||me.resolve().then(e),n&&t(e)):w?(w.push(e),n&&t(e)):(t(e),n||t(function t(){k.on.ready.unsubscribe(e),k.on.ready.unsubscribe(t)}))})}}),this.transaction=function(){var t=function(t,e,n){var r=arguments.length;if(r<2)throw new Tt.InvalidArgument("Too few arguments");var i=new Array(r-1);for(;--r;)i[r-1]=arguments[r];n=i.pop();var o=ft(i);return[t,o,n]}.apply(this,arguments);return this._transaction.apply(this,t)},this._transaction=function(t,e,n){var r=pe.trans;r&&r.db===k&&-1===t.indexOf("!")||(r=null);var i=-1!==t.indexOf("?");t=t.replace("!","").replace("?","");try{var o=e.map(function(t){var e=t instanceof P?t.name:t;if("string"!=typeof e)throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return e});if("r"==t||"readonly"==t)t="readonly";else{if("rw"!=t&&t!=x)throw new Tt.InvalidArgument("Invalid transaction mode: "+t);t=x}if(r){if("readonly"===r.mode&&t===x){if(!i)throw new Tt.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");r=null}r&&o.forEach(function(t){if(r&&-1===r.storeNames.indexOf(t)){if(!i)throw new Tt.SubTransaction("Table "+t+" not included in parent transaction.");r=null}}),i&&r&&!r.active&&(r=null)}}catch(t){return r?r._promise(null,function(e,n){n(t)}):He(t)}return r?r._promise(t,s,"lock"):pe.trans?ze(pe.transless,function(){return k._whenReady(s)}):k._whenReady(s);function s(){return me.resolve().then(function(){var e,i=pe.transless||pe,s=k._createTransaction(t,o,p,r),a={trans:s,transless:i};r?s.idbtrans=r.idbtrans:s.create(),n.constructor===ee&&Fe();var u=me.follow(function(){if(e=n.call(s,s))if(e.constructor===te){var t=Ue.bind(null,null);e.then(t,t)}else"function"==typeof e.next&&"function"==typeof e.throw&&(e=vn(e))},a);return(e&&"function"==typeof e.then?me.resolve(e).then(function(t){return s.active?t:He(new Tt.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):u.then(function(){return e})).then(function(t){return r&&s._resolve(),s._completion.then(function(){return t})}).catch(function(t){return s._reject(t),He(t)})})}},this.table=function(t){if(!Q(v,t))throw new Tt.InvalidTable("Table "+t+" does not exist");return v[t]},H(P.prototype,{_trans:function(t,e,n){var r=this._tx||pe.trans;return r&&r.db===k?r===pe.trans?r._promise(t,e,n):Le(function(){return r._promise(t,e,n)},{trans:r,transless:pe.transless||pe}):function t(e,n,r){if(_||pe.letThrough){var i=k._createTransaction(e,n,p);try{i.create()}catch(t){return He(t)}return i._promise(e,function(t,e){return Le(function(){return pe.trans=i,r(t,e,i)})}).then(function(t){return i._completion.then(function(){return t})})}if(!y){if(!l)return He(new Tt.DatabaseClosed);k.open().catch(Lt)}return O.then(function(){return t(e,n,r)})}(t,[this.name],e)},_idbstore:function(t,e,n){var r=this.name;return this._trans(t,function(t,n,i){if(-1===i.storeNames.indexOf(r))throw new Tt.NotFound("Table"+r+" not part of transaction");return e(t,n,i.idbtrans.objectStore(r),i)},n)},get:function(t,e){if(t&&t.constructor===Object)return this.where(t).first(e);var n=this;return this._idbstore("readonly",function(e,r,i){var o=i.get(t);o.onerror=fn(r),o.onsuccess=Ie(function(){e(n.hook.reading.fire(o.result))},r)}).then(e)},where:function(t){if("string"==typeof t)return new M(this,t);if(q(t))return new M(this,"["+t.join("+")+"]");var e=B(t);if(1===e.length)return this.where(e[0]).equals(t[e[0]]);var n=this.schema.indexes.concat(this.schema.primKey).filter(function(t){return t.compound&&e.every(function(e){return t.keyPath.indexOf(e)>=0})&&t.keyPath.every(function(t){return e.indexOf(t)>=0})})[0];if(n&&Ge!==Je)return this.where(n.name).equals(n.keyPath.map(function(e){return t[e]}));n||console.warn("The query "+JSON.stringify(t)+" on "+this.name+" would benefit of a compound index ["+e.join("+")+"]");var r=this.schema.idxByName,i=e.reduce(function(e,n){return[e[0]||r[n],e[0]||!r[n]?it(e[1],function(e){return""+ut(e,n)==""+t[n]}):e[1]]},[null,null]),o=i[0];return o?this.where(o.name).equals(t[o.keyPath]).filter(i[1]):n?this.filter(i[1]):this.where(e).equals("")},count:function(t){return this.toCollection().count(t)},offset:function(t){return this.toCollection().offset(t)},limit:function(t){return this.toCollection().limit(t)},reverse:function(){return this.toCollection().reverse()},filter:function(t){return this.toCollection().and(t)},each:function(t){return this.toCollection().each(t)},toArray:function(t){return this.toCollection().toArray(t)},orderBy:function(t){return new L(new M(this,q(t)?"["+t.join("+")+"]":t))},toCollection:function(){return new L(new M(this))},mapToClass:function(t,e){this.schema.mappedClass=t;var n=Object.create(t.prototype);e&&ln(n,e),this.schema.instanceTemplate=n;var r=function(e){if(!e)return e;var n=Object.create(t.prototype);for(var r in e)if(Q(e,r))try{n[r]=e[r]}catch(t){}return n};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=r,this.hook("reading",r),t},defineClass:function(t){return this.mapToClass(cn.defineClass(t),t)},bulkDelete:function(t){return this.hook.deleting.fire===Lt?this._idbstore(x,function(e,n,r,i){e(T(r,i,t,!1,Lt))}):this.where(":id").anyOf(t).delete().then(function(){})},bulkPut:function(t,e){var n=this;return this._idbstore(x,function(r,i,o){if(!o.keyPath&&!n.schema.primKey.auto&&!e)throw new Tt.InvalidArgument("bulkPut() with non-inbound keys requires keys array in second argument");if(o.keyPath&&e)throw new Tt.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(e&&e.length!==t.length)throw new Tt.InvalidArgument("Arguments objects and keys must have the same length");if(0===t.length)return r();var s,a,u=function(t){0===c.length?r(t):i(new Rt(n.name+".bulkPut(): "+c.length+" of "+l+" operations failed",c))},c=[],l=t.length,h=n;if(n.hook.creating.fire===Lt&&n.hook.updating.fire===Lt){a=D(c);for(var f=0,p=t.length;f<p;++f)(s=e?o.put(t[f],e[f]):o.put(t[f])).onerror=a;s.onerror=D(c,u),s.onsuccess=pn(u)}else{var d=e||o.keyPath&&t.map(function(t){return ut(t,o.keyPath)}),g=d&&ot(d,function(e,n){return null!=e&&[e,t[n]]});(d?h.where(":id").anyOf(d.filter(function(t){return null!=t})).modify(function(){this.value=g[this.primKey],g[this.primKey]=null}).catch(It,function(t){c=t.failures}).then(function(){for(var n=[],r=e&&[],i=d.length-1;i>=0;--i){var o=d[i];(null==o||g[o])&&(n.push(t[i]),e&&r.push(o),null!=o&&(g[o]=null))}return n.reverse(),e&&r.reverse(),h.bulkAdd(n,r)}).then(function(t){var e=d[d.length-1];return null!=e?e:t}):h.bulkAdd(t)).then(u).catch(Rt,function(t){c=c.concat(t.failures),u()}).catch(i)}},"locked")},bulkAdd:function(t,e){var n=this,r=this.hook.creating.fire;return this._idbstore(x,function(i,o,s,a){if(!s.keyPath&&!n.schema.primKey.auto&&!e)throw new Tt.InvalidArgument("bulkAdd() with non-inbound keys requires keys array in second argument");if(s.keyPath&&e)throw new Tt.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(e&&e.length!==t.length)throw new Tt.InvalidArgument("Arguments objects and keys must have the same length");if(0===t.length)return i();function u(t){0===f.length?i(t):o(new Rt(n.name+".bulkAdd(): "+f.length+" of "+p+" operations failed",f))}var c,l,h,f=[],p=t.length;if(r!==Lt){var d,g=s.keyPath;l=D(f,null,!0),h=hn(null),at(function(){for(var n=0,i=t.length;n<i;++n){d={onerror:null,onsuccess:null};var o=e&&e[n],u=t[n],f=e?o:g?ut(u,g):void 0,p=r.call(d,f,u,a);null==f&&null!=p&&(g?ct(u=dt(u),g,p):o=p),(c=null!=o?s.add(u,o):s.add(u))._hookCtx=d,n<i-1&&(c.onerror=l,d.onsuccess&&(c.onsuccess=h))}},function(t){throw d.onerror&&d.onerror(t),t}),c.onerror=D(f,u,!0),c.onsuccess=hn(u)}else{l=D(f);for(var v=0,m=t.length;v<m;++v)(c=e?s.add(t[v],e[v]):s.add(t[v])).onerror=l;c.onerror=D(f,u),c.onsuccess=pn(u)}})},add:function(t,e){var n=this.hook.creating.fire;return this._idbstore(x,function(r,i,o,s){var a={onsuccess:null,onerror:null};if(n!==Lt){var u=null!=e?e:o.keyPath?ut(t,o.keyPath):void 0,c=n.call(a,u,t,s);null==u&&null!=c&&(o.keyPath?ct(t,o.keyPath,c):e=c)}try{var l=null!=e?o.add(t,e):o.add(t);l._hookCtx=a,l.onerror=dn(i),l.onsuccess=hn(function(e){var n=o.keyPath;n&&ct(t,n,e),r(e)})}catch(t){throw a.onerror&&a.onerror(t),t}})},put:function(t,e){var n=this,r=this.hook.creating.fire,i=this.hook.updating.fire;if(r!==Lt||i!==Lt){var o=this.schema.primKey.keyPath,s=void 0!==e?e:o&&ut(t,o);return null==s?this.add(t):(t=dt(t),this._trans(x,function(){return n.where(":id").equals(s).modify(function(){this.value=t}).then(function(r){return 0===r?n.add(t,e):s})},"locked"))}return this._idbstore(x,function(n,r,i){var o=void 0!==e?i.put(t,e):i.put(t);o.onerror=fn(r),o.onsuccess=Ie(function(e){var r=i.keyPath;r&&ct(t,r,e.target.result),n(o.result)})})},delete:function(t){return this.hook.deleting.subscribers.length?this.where(":id").equals(t).delete():this._idbstore(x,function(e,n,r){var i=r.delete(t);i.onerror=fn(n),i.onsuccess=Ie(function(){e(i.result)})})},clear:function(){return this.hook.deleting.subscribers.length?this.toCollection().delete():this._idbstore(x,function(t,e,n){var r=n.clear();r.onerror=fn(e),r.onsuccess=Ie(function(){t(r.result)})})},update:function(t,e){if("object"!=typeof e||q(e))throw new Tt.InvalidArgument("Modifications must be an object.");if("object"!=typeof t||q(t))return this.where(":id").equals(t).modify(e);B(e).forEach(function(n){ct(t,n,e[n])});var n=ut(t,this.schema.primKey.keyPath);return void 0===n?He(new Tt.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(n).modify(e)}}),H(N.prototype,{_lock:function(){return rt(!pe.global),++this._reculock,1!==this._reculock||pe.global||(pe.lockOwnerFor=this),this},_unlock:function(){if(rt(!pe.global),0==--this._reculock)for(pe.global||(pe.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var t=this._blockedFuncs.shift();try{ze(t[1],t[0])}catch(t){}}return this},_locked:function(){return this._reculock&&pe.lockOwnerFor!==this},create:function(t){var e=this;if(!this.mode)return this;if(rt(!this.idbtrans),!t&&!m)switch(b&&b.name){case"DatabaseClosedError":throw new Tt.DatabaseClosed(b);case"MissingAPIError":throw new Tt.MissingAPI(b.message,b);default:throw new Tt.OpenFailed(b)}if(!this.active)throw new Tt.TransactionInactive;return rt(null===this._completion._state),(t=this.idbtrans=t||m.transaction(yn(this.storeNames),this.mode)).onerror=Ie(function(n){gn(n),e._reject(t.error)}),t.onabort=Ie(function(n){gn(n),e.active&&e._reject(new Tt.Abort(t.error)),e.active=!1,e.on("abort").fire(n)}),t.oncomplete=Ie(function(){e.active=!1,e._resolve()}),this},_promise:function(t,e,n){var r=this;if(t===x&&this.mode!==x)return He(new Tt.ReadOnly("Transaction is readonly"));if(!this.active)return He(new Tt.TransactionInactive);if(this._locked())return new me(function(i,o){r._blockedFuncs.push([function(){r._promise(t,e,n).then(i,o)},pe])});if(n)return Le(function(){var t=new me(function(t,n){r._lock();var i=e(t,n,r);i&&i.then&&i.then(t,n)});return t.finally(function(){return r._unlock()}),t._lib=!0,t});var i=new me(function(t,n){var i=e(t,n,r);i&&i.then&&i.then(t,n)});return i._lib=!0,i},_root:function(){return this.parent?this.parent._root():this},waitFor:function(t){var e=this._root();if(t=me.resolve(t),e._waitingFor)e._waitingFor=e._waitingFor.then(function(){return t});else{e._waitingFor=t,e._waitingQueue=[];var n=e.idbtrans.objectStore(e.storeNames[0]);!function t(){for(++e._spinCount;e._waitingQueue.length;)e._waitingQueue.shift()();e._waitingFor&&(n.get(-1/0).onsuccess=t)}()}var r=e._waitingFor;return new me(function(n,i){t.then(function(t){return e._waitingQueue.push(Ie(n.bind(null,t)))},function(t){return e._waitingQueue.push(Ie(i.bind(null,t)))}).finally(function(){e._waitingFor===r&&(e._waitingFor=null)})})},abort:function(){this.active&&this._reject(new Tt.Abort),this.active=!1},tables:{get:(o="Transaction.tables",s=function(){return v},function(){return console.warn(o+" is deprecated. See https://github.com/dfahlander/Dexie.js/wiki/Deprecations. "+St(Ot(),1)),s.apply(this,arguments)})},table:function(t){var e=k.table(t);return new P(t,e.schema,this)}}),H(M.prototype,function(){function t(t,e,n){var r=t instanceof M?new L(t):t;return r._ctx.error=n?new n(e):new TypeError(e),r}function e(t){return new L(t,function(){return f.only("")}).limit(0)}function n(t,e,n,r,i,o){for(var s=Math.min(t.length,r.length),a=-1,u=0;u<s;++u){var c=e[u];if(c!==r[u])return i(t[u],n[u])<0?t.substr(0,u)+n[u]+n.substr(u+1):i(t[u],r[u])<0?t.substr(0,u)+r[u]+n.substr(u+1):a>=0?t.substr(0,a)+e[a]+n.substr(a+1):null;i(t[u],c)<0&&(a=u)}return s<r.length&&"next"===o?t+n.substr(t.length):s<t.length&&"prev"===o?t.substr(0,n.length):a<0?null:t.substr(0,a)+r[a]+n.substr(a+1)}function r(e,r,i,o){var s,a,u,c,l,h,p,d=i.length;if(!i.every(function(t){return"string"==typeof t}))return t(e,nn);function g(t){s=function(t){return"next"===t?function(t){return t.toUpperCase()}:function(t){return t.toLowerCase()}}(t),a=function(t){return"next"===t?function(t){return t.toLowerCase()}:function(t){return t.toUpperCase()}}(t),u="next"===t?G:tt;var e=i.map(function(t){return{lower:a(t),upper:s(t)}}).sort(function(t,e){return u(t.lower,e.lower)});c=e.map(function(t){return t.upper}),l=e.map(function(t){return t.lower}),h=t,p="next"===t?"":o}g("next");var v=new L(e,function(){return f.bound(c[0],l[d-1]+o)});v._ondirectionchange=function(t){g(t)};var m=0;return v._addAlgorithm(function(t,e,i){var o=t.key;if("string"!=typeof o)return!1;var s=a(o);if(r(s,l,m))return!0;for(var f=null,g=m;g<d;++g){var v=n(o,s,c[g],l[g],u,h);null===v&&null===f?m=g+1:(null===f||u(f,v)>0)&&(f=v)}return e(null!==f?function(){t.continue(f+p)}:i),!1}),v}return{between:function(n,r,i,o){i=!1!==i,o=!0===o;try{return Z(n,r)>0||0===Z(n,r)&&(i||o)&&(!i||!o)?e(this):new L(this,function(){return f.bound(n,r,!i,!o)})}catch(e){return t(this,en)}},equals:function(t){return new L(this,function(){return f.only(t)})},above:function(t){return new L(this,function(){return f.lowerBound(t,!0)})},aboveOrEqual:function(t){return new L(this,function(){return f.lowerBound(t)})},below:function(t){return new L(this,function(){return f.upperBound(t,!0)})},belowOrEqual:function(t){return new L(this,function(){return f.upperBound(t)})},startsWith:function(e){return"string"!=typeof e?t(this,nn):this.between(e,e+Je,!0,!0)},startsWithIgnoreCase:function(t){return""===t?this.startsWith(t):r(this,function(t,e){return 0===t.indexOf(e[0])},[t],Je)},equalsIgnoreCase:function(t){return r(this,function(t,e){return t===e[0]},[t],"")},anyOfIgnoreCase:function(){var t=yt.apply(bt,arguments);return 0===t.length?e(this):r(this,function(t,e){return-1!==e.indexOf(t)},t,"")},startsWithAnyOfIgnoreCase:function(){var t=yt.apply(bt,arguments);return 0===t.length?e(this):r(this,function(t,e){return e.some(function(e){return 0===t.indexOf(e)})},t,Je)},anyOf:function(){var n=yt.apply(bt,arguments),r=Y;try{n.sort(r)}catch(e){return t(this,en)}if(0===n.length)return e(this);var i=new L(this,function(){return f.bound(n[0],n[n.length-1])});i._ondirectionchange=function(t){r="next"===t?Y:J,n.sort(r)};var o=0;return i._addAlgorithm(function(t,e,i){for(var s=t.key;r(s,n[o])>0;)if(++o===n.length)return e(i),!1;return 0===r(s,n[o])||(e(function(){t.continue(n[o])}),!1)}),i},notEqual:function(t){return this.inAnyRange([[tn,t],[t,Ge]],{includeLowers:!1,includeUppers:!1})},noneOf:function(){var e=yt.apply(bt,arguments);if(0===e.length)return new L(this);try{e.sort(Y)}catch(e){return t(this,en)}var n=e.reduce(function(t,e){return t?t.concat([[t[t.length-1][1],e]]):[[tn,e]]},null);return n.push([e[e.length-1],Ge]),this.inAnyRange(n,{includeLowers:!1,includeUppers:!1})},inAnyRange:function(n,r){if(0===n.length)return e(this);if(!n.every(function(t){return void 0!==t[0]&&void 0!==t[1]&&Y(t[0],t[1])<=0}))return t(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",Tt.InvalidArgument);var i=!r||!1!==r.includeLowers,o=r&&!0===r.includeUppers;var s,a=Y;function u(t,e){return a(t[0],e[0])}try{(s=n.reduce(function(t,e){for(var n=0,r=t.length;n<r;++n){var i=t[n];if(Z(e[0],i[1])<0&&Z(e[1],i[0])>0){i[0]=(o=i[0],s=e[0],Z(o,s)<0?o:s),i[1]=W(i[1],e[1]);break}}var o,s;return n===r&&t.push(e),t},[])).sort(u)}catch(e){return t(this,en)}var c=0,l=o?function(t){return Y(t,s[c][1])>0}:function(t){return Y(t,s[c][1])>=0},h=i?function(t){return J(t,s[c][0])>0}:function(t){return J(t,s[c][0])>=0};var p=l,d=new L(this,function(){return f.bound(s[0][0],s[s.length-1][1],!i,!o)});return d._ondirectionchange=function(t){"next"===t?(p=l,a=Y):(p=h,a=J),s.sort(u)},d._addAlgorithm(function(t,e,n){for(var r=t.key;p(r);)if(++c===s.length)return e(n),!1;return!!function(t){return!l(t)&&!h(t)}(r)||0!==Z(r,s[c][1])&&0!==Z(r,s[c][0])&&(e(function(){a===Y?t.continue(s[c][0]):t.continue(s[c][1])}),!1)}),d},startsWithAnyOf:function(){var n=yt.apply(bt,arguments);return n.every(function(t){return"string"==typeof t})?0===n.length?e(this):this.inAnyRange(n.map(function(t){return[t,t+Je]})):t(this,"startsWithAnyOf() only works with strings")}}}),H(L.prototype,function(){function t(t,e){t.filter=it(t.filter,e)}function e(t,e,n){var r=t.replayFilter;t.replayFilter=r?function(){return it(r(),e())}:e,t.justLimit=n&&!r}function n(t,e){if(t.isPrimKey)return e;var n=t.table.schema.idxByName[t.index];if(!n)throw new Tt.Schema("KeyPath "+t.index+" on object store "+e.name+" is not indexed");return e.index(n.name)}function r(t,e){var r=n(t,e);return t.keysOnly&&"openKeyCursor"in r?r.openKeyCursor(t.range||null,t.dir+t.unique):r.openCursor(t.range||null,t.dir+t.unique)}function o(t,e,n,i,o){var s=t.replayFilter?it(t.filter,t.replayFilter()):t.filter;t.or?function(){var a={},u=0;function c(){2==++u&&n()}function l(t,n,r){if(!s||s(n,r,c,i)){var o=n.primaryKey,u=""+o;"[object ArrayBuffer]"===u&&(u=""+new Uint8Array(o)),Q(a,u)||(a[u]=!0,e(t,n,r))}}t.or._iterate(l,c,i,o),K(r(t,o),t.algorithm,l,c,i,!t.keysOnly&&t.valueMapper)}():K(r(t,o),it(t.algorithm,s),e,n,i,!t.keysOnly&&t.valueMapper)}return{_read:function(t,e){var n=this._ctx;return n.error?n.table._trans(null,He.bind(null,n.error)):n.table._idbstore("readonly",t).then(e)},_write:function(t){var e=this._ctx;return e.error?e.table._trans(null,He.bind(null,e.error)):e.table._idbstore(x,t,"locked")},_addAlgorithm:function(t){var e=this._ctx;e.algorithm=it(e.algorithm,t)},_iterate:function(t,e,n,r){return o(this._ctx,t,e,n,r)},clone:function(t){var e=Object.create(this.constructor.prototype),n=Object.create(this._ctx);return t&&V(n,t),e._ctx=n,e},raw:function(){return this._ctx.valueMapper=null,this},each:function(t){var e=this._ctx;return this._read(function(n,r,i){o(e,t,n,r,i)})},count:function(t){var e=this._ctx;if(F(e,!0))return this._read(function(t,r,i){var o=n(e,i),s=e.range?o.count(e.range):o.count();s.onerror=fn(r),s.onsuccess=function(n){t(Math.min(n.target.result,e.limit))}},t);var r=0;return this._read(function(t,n,i){o(e,function(){return++r,!1},function(){t(r)},n,i)},t)},sortBy:function(t,e){var n=t.split(".").reverse(),r=n[0],i=n.length-1;function o(t,e){return e?o(t[n[e]],e-1):t[r]}var s="next"===this._ctx.dir?1:-1;function a(t,e){var n=o(t,i),r=o(e,i);return n<r?-s:n>r?s:0}return this.toArray(function(t){return t.sort(a)}).then(e)},toArray:function(t){var e=this._ctx;return this._read(function(t,r,s){if(i&&"next"===e.dir&&F(e,!0)&&e.limit>0){var a=e.table.hook.reading.fire,u=n(e,s),c=e.limit<1/0?u.getAll(e.range,e.limit):u.getAll(e.range);c.onerror=fn(r),c.onsuccess=pn(a===Ft?t:function(e){try{t(e.map(a))}catch(t){r(t)}})}else{var l=[];o(e,function(t){l.push(t)},function(){t(l)},r,s)}},t)},offset:function(t){var n=this._ctx;return t<=0?this:(n.offset+=t,F(n)?e(n,function(){var e=t;return function(t,n){return 0===e||(1===e?(--e,!1):(n(function(){t.advance(e),e=0}),!1))}}):e(n,function(){var e=t;return function(){return--e<0}}),this)},limit:function(t){return this._ctx.limit=Math.min(this._ctx.limit,t),e(this._ctx,function(){var e=t;return function(t,n,r){return--e<=0&&n(r),e>=0}},!0),this},until:function(e,n){return t(this._ctx,function(t,r,i){return!e(t.value)||(r(i),n)}),this},first:function(t){return this.limit(1).toArray(function(t){return t[0]}).then(t)},last:function(t){return this.reverse().first(t)},filter:function(e){return t(this._ctx,function(t){return e(t.value)}),function(t,e){t.isMatch=it(t.isMatch,e)}(this._ctx,e),this},and:function(t){return this.filter(t)},or:function(t){return new M(this._ctx.table,t,this)},reverse:function(){return this._ctx.dir="prev"===this._ctx.dir?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},desc:function(){return this.reverse()},eachKey:function(t){var e=this._ctx;return e.keysOnly=!e.isMatch,this.each(function(e,n){t(n.key,n)})},eachUniqueKey:function(t){return this._ctx.unique="unique",this.eachKey(t)},eachPrimaryKey:function(t){var e=this._ctx;return e.keysOnly=!e.isMatch,this.each(function(e,n){t(n.primaryKey,n)})},keys:function(t){var e=this._ctx;e.keysOnly=!e.isMatch;var n=[];return this.each(function(t,e){n.push(e.key)}).then(function(){return n}).then(t)},primaryKeys:function(t){var e=this._ctx;if(i&&"next"===e.dir&&F(e,!0)&&e.limit>0)return this._read(function(t,r,i){var o=n(e,i),s=e.limit<1/0?o.getAllKeys(e.range,e.limit):o.getAllKeys(e.range);s.onerror=fn(r),s.onsuccess=pn(t)}).then(t);e.keysOnly=!e.isMatch;var r=[];return this.each(function(t,e){r.push(e.primaryKey)}).then(function(){return r}).then(t)},uniqueKeys:function(t){return this._ctx.unique="unique",this.keys(t)},firstKey:function(t){return this.limit(1).keys(function(t){return t[0]}).then(t)},lastKey:function(t){return this.reverse().firstKey(t)},distinct:function(){var e=this._ctx,n=e.index&&e.table.schema.idxByName[e.index];if(!n||!n.multi)return this;var r={};return t(this._ctx,function(t){var e=t.primaryKey.toString(),n=Q(r,e);return r[e]=!0,!n}),this},modify:function(t){var e=this,n=this._ctx.table.hook,r=n.updating.fire,i=n.deleting.fire;return this._write(function(n,o,s,a){var u;if("function"==typeof t)u=r===Lt&&i===Lt?t:function(e){var n=dt(e);if(!1===t.call(this,e,this))return!1;if(Q(this,"value")){var o=gt(n,this.value),s=r.call(this,o,this.primKey,n,a);s&&(e=this.value,B(s).forEach(function(t){ct(e,t,s[t])}))}else i.call(this,this.primKey,e,a)};else if(r===Lt){var c=B(t),l=c.length;u=function(e){for(var n=!1,r=0;r<l;++r){var i=c[r],o=t[i];ut(e,i)!==o&&(ct(e,i,o),n=!0)}return n}}else{var h=t;t=lt(h),u=function(e){var n=!1,i=r.call(this,t,this.primKey,dt(e),a);return i&&V(t,i),B(t).forEach(function(r){var i=t[r];ut(e,r)!==i&&(ct(e,r,i),n=!0)}),i&&(t=lt(h)),n}}var f=0,p=0,d=!1,g=[],v=[],m=null;function b(t){return t&&(g.push(t),v.push(m)),o(new It("Error modifying one or more objects",g,p,v))}function y(){d&&p+g.length===f&&(g.length>0?b():n(p))}e.clone().raw()._iterate(function(t,e){m=e.primaryKey;var n={primKey:e.primaryKey,value:t,onsuccess:null,onerror:null};function r(t){return g.push(t),v.push(n.primKey),y(),!0}if(!1!==u.call(n,t,n)){var i=!Q(n,"value");++f,at(function(){var t=i?e.delete():e.update(n.value);t._hookCtx=n,t.onerror=dn(r),t.onsuccess=hn(function(){++p,y()})},r)}else n.onsuccess&&n.onsuccess(n.value)},function(){d=!0,y()},b,s)})},delete:function(){var t=this,e=this._ctx,n=e.range,r=e.table.hook.deleting.fire,i=r!==Lt;if(!i&&F(e)&&(e.isPrimKey&&!an||!n))return this._write(function(t,e,r){var i=fn(e),o=n?r.count(n):r.count();o.onerror=i,o.onsuccess=function(){var s=o.result;at(function(){var e=n?r.delete(n):r.clear();e.onerror=i,e.onsuccess=function(){return t(s)}},function(t){return e(t)})}});var o=i?2e3:1e4;return this._write(function(n,s,a,u){var c=0,l=t.clone({keysOnly:!e.isMatch&&!i}).distinct().limit(o).raw(),h=[];n(function t(){return l.each(i?function(t,e){h.push([e.primaryKey,e.value])}:function(t,e){h.push(e.primaryKey)}).then(function(){return i?h.sort(function(t,e){return Y(t[0],e[0])}):h.sort(Y),T(a,u,h,i,r)}).then(function(){var e=h.length;return c+=e,h=[],e<o?c:t()})}())})}}}),V(this,{Collection:L,Table:P,Transaction:N,Version:A,WhereClause:M}),k.on("versionchange",function(t){t.newVersion>0?console.warn("Another connection wants to upgrade database '"+k.name+"'. Closing db now to resume the upgrade."):console.warn("Another connection wants to delete database '"+k.name+"'. Closing db now to resume the delete request."),k.close()}),k.on("blocked",function(t){!t.newVersion||t.newVersion<t.oldVersion?console.warn("Dexie.delete('"+k.name+"') was blocked"):console.warn("Upgrade '"+k.name+"' blocked by other connection holding version "+t.oldVersion/10)}),c.forEach(function(t){t(k)})}function ln(t,e){return B(e).forEach(function(n){var r=function t(e){if("function"==typeof e)return new e;if(q(e))return[t(e[0])];if(e&&"object"==typeof e){var n={};return ln(n,e),n}return e}(e[n]);t[n]=r}),t}function hn(t){return Ie(function(e){var n=e.target,r=n._hookCtx,i=r.value||n.result,o=r&&r.onsuccess;o&&o(i),t&&t(i)},t)}function fn(t){return Ie(function(e){return gn(e),t(e.target.error),!1})}function pn(t){return Ie(function(e){t(e.target.result)})}function dn(t){return Ie(function(e){var n=e.target,r=n.error,i=n._hookCtx,o=i&&i.onerror;return o&&o(r),gn(e),t(r),!1})}function gn(t){t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault()}function vn(t){var e=function(e){return t.next(e)},n=i(e),r=i(function(e){return t.throw(e)});function i(t){return function(e){var i=t(e),o=i.value;return i.done?o:o&&"function"==typeof o.then?o.then(n,r):q(o)?me.all(o).then(n,r):n(o)}}return i(e)()}function mn(t,e,n,r,i,o,s){this.name=t,this.keyPath=e,this.unique=n,this.multi=r,this.auto=i,this.compound=o,this.dotted=s;var a="string"==typeof e?e:e&&"["+[].join.call(e,"+")+"]";this.src=(n?"&":"")+(r?"*":"")+(i?"++":"")+a}function bn(t,e,n,r){this.name=t,this.primKey=e||new mn,this.indexes=n||[new mn],this.instanceTemplate=r,this.mappedClass=null,this.idxByName=ot(n,function(t){return[t.name,t]})}function yn(t){return 1===t.length?t[0]:t}function wn(t){var e=t&&(t.getDatabaseNames||t.webkitGetDatabaseNames);return e&&e.bind(t)}_t(wt,un),H(cn,Mt),H(cn,{delete:function(t){var e=new cn(t),n=e.delete();return n.onblocked=function(t){return e.on("blocked",t),this},n},exists:function(t){return new cn(t).open().then(function(t){return t.close(),!0}).catch(cn.NoSuchDatabaseError,function(){return!1})},getDatabaseNames:function(t){var e=wn(cn.dependencies.indexedDB);return e?new me(function(t,n){var r=e();r.onsuccess=function(e){t(et(e.target.result,0))},r.onerror=fn(n)}).then(t):Xe.dbnames.toCollection().primaryKeys(t)},defineClass:function(){return function(t){t&&V(this,t)}},applyStructure:ln,ignoreTransaction:function(t){return pe.trans?ze(pe.transless,t):t()},vip:function(t){return Le(function(){return pe.letThrough=!0,t()})},async:function(t){return function(){try{var e=vn(t.apply(this,arguments));return e&&"function"==typeof e.then?e:me.resolve(e)}catch(t){return He(t)}}},spawn:function(t,e,n){try{var r=vn(t.apply(n,e||[]));return r&&"function"==typeof r.then?r:me.resolve(r)}catch(t){return He(t)}},currentTransaction:{get:function(){return pe.trans||null}},waitFor:function(t,e){var n=me.resolve("function"==typeof t?cn.ignoreTransaction(t):t).timeout(e||6e4);return pe.trans?pe.trans.waitFor(n):n},Promise:me,debug:{get:function(){return wt},set:function(t){_t(t,"dexie"===t?function(){return!0}:un)}},derive:J,extend:V,props:H,override:nt,Events:Ye,getByKeyPath:ut,setByKeyPath:ct,delByKeyPath:function(t,e){"string"==typeof e?ct(t,e,void 0):"length"in e&&[].map.call(e,function(e){ct(t,e,void 0)})},shallowClone:lt,deepClone:dt,getObjectDiff:gt,asap:it,maxKey:Ge,minKey:tn,addons:[],connections:rn,MultiModifyError:Tt.Modify,errnames:Pt,IndexSpec:mn,TableSchema:bn,dependencies:function(){try{return{indexedDB:z.indexedDB||z.mozIndexedDB||z.webkitIndexedDB||z.msIndexedDB,IDBKeyRange:z.IDBKeyRange||z.webkitIDBKeyRange}}catch(t){return{indexedDB:null,IDBKeyRange:null}}}(),semVer:"{version}",version:"{version}".split(".").map(function(t){return parseInt(t)}).reduce(function(t,e,n){return t+e/Math.pow(10,2*n)}),default:cn,Dexie:cn}),me.rejectionMapper=function(t,e){if(!t||t instanceof Ct||t instanceof TypeError||t instanceof SyntaxError||!t.name||!Nt[t.name])return t;var n=new Nt[t.name](e||t.message,t);return"stack"in t&&X(n,"stack",{get:function(){return this.inner.stack}}),n},(Xe=new cn("__dbnames")).version(1).stores({dbnames:"name"}),function(){try{void 0!==typeof localStorage&&void 0!==z.document&&(JSON.parse(localStorage.getItem("Dexie.DatabaseNames")||"[]").forEach(function(t){return Xe.dbnames.put({name:t}).catch(Lt)}),localStorage.removeItem("Dexie.DatabaseNames"))}catch(t){}}();var _n=cn;function xn(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var kn=function(){var t=this;this.open=function(){return t.idb.open()},this.loadConfig=function(){return t.idb.Config.get(0)},this.saveConfig=function(e){return t.idb.Config.put(function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),r.forEach(function(e){xn(t,e,n[e])})}return t}({id:0},e))},this.saveDraft=function(e,n){return t.idb.Drafts.put({id:e||"",text:n,time:(new Date).toISOString()})},this.getDraft=function(e){return t.idb.Drafts.get({id:e||""})},this.dropDraft=function(e){return t.idb.Drafts.delete(e||"")},this.createNote=function(e){var n=Date.now().toString(36),r=n+Math.random().toString(36).substring(1,4),i=(new Date).toISOString(),o={id:r,lastReview:i,nextReview:i,text:e,ver:n};return t.idb.Notes.add(o)},this.getNote=function(e){return t.idb.Notes.get(e)},this.getNotes=function(){return t.idb.Notes.toArray()},this.updateNote=function(e,n){var r=Date.now().toString(36);return t.idb.Notes.put({id:e,text:n,ver:r})},this.getNotesToReview=function(){var e=(new Date).toISOString();return t.idb.Notes.where("nextReview").below(e).limit(E.QUEUE_LIMIT).toArray().then(On)},this.addReview=function(e,n){var r={note:e.id,time:(new Date).toISOString(),result:n},i=new Date,o=new Date(e.lastReview),s=function(t,e,n){console.assert(t>=0,"expected interval can't be negative"),console.assert(e>=0,"actual interval can't be negative");var r=[1,2,3,5,8,13,21,34,55,89,144];if("hard"===n){var i=Math.min(e,t)/864e5,o=r.findIndex(function(t){return t>=i});return 864e5*r[o>0?o-1:0]}if("easy"===n){if(e<.6*t)return t;var s=Math.max(t,e)/864e5,a=r.findIndex(function(t){return t>s});return 864e5*r[a>=0?a:r.length-1]}console.error("Unexpected review result",n)}(new Date(e.nextReview)-o,i-o,n),a=new Date(i.valueOf()+s).toISOString();return t.idb.Notes.update(e.id,{lastReview:i.toISOString(),nextReview:a}).then(function(){return t.idb.Reviews.add(r)})},this.pushToServer=function(){return t.idb.Notes.toArray().then(function(e){return t.idb.Reviews.toArray().then(function(t){return fetch(E.SYNC_SERVER_URL+"/"+E.CLIENT_KEY,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify({notes:e,reviews:t})}).then(function(t){t.ok})})})},this.pullFromServer=function(){return fetch(E.SYNC_SERVER_URL+"/"+E.CLIENT_KEY).then(function(t){return t.json()}).then(function(e){return t.idb.Notes.bulkPut(e.notes).then(function(){return t.idb.Reviews.bulkPut(e.reviews)})})};var e=0;this.idb=new _n("fhmp"),this.idb.version(++e).stores({Config:"id",Drafts:"id",Notes:"id,nextReview",Reviews:"time"}),console.assert(!0,"DB version mismatch")};function On(t){for(var e=t.length-1;e>0;e--){var n=Math.floor(Math.random()*(e+1)),r=[t[n],t[e]];t[e]=r[0],t[n]=r[1]}return t}function Sn(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}var jn=function(t){function e(e){var n;return(n=t.call(this,e)||this).state={db:null},n}Sn(e,t);var n=e.prototype;return n.componentDidMount=function(){var t=this,e=new kn;e.open().then(function(){return function(t){return t.loadConfig().then(function(t){if(t)for(var e in j)e in t&&(j[e]=t[e])})}(e)}).then(function(){return t.setState({db:e})}).catch(function(e){return t.onMessage({error:!0,err:e,msg:"Loading form DB failed"})}),document.body.classList.add("has-navbar-fixed-top"),document.body.classList.add("has-navbar-fixed-bottom"),navigator.storage&&navigator.storage.persist()},n.render=function(){var t=this.state,e=t.db;t.url,t.message;return e?Object(o.h)(O,null,Object(o.h)(En,{path:E.URL_PREFIX,to:"/fhmp/list"}),Object(o.h)(M,{path:E.URL_PREFIX+"/list",db:e}),Object(o.h)(L,{path:E.URL_PREFIX+"/new",db:e}),Object(o.h)(L,{path:E.URL_PREFIX+"/edit/:noteId",db:e}),Object(o.h)(T,{path:E.URL_PREFIX+"/review",db:e}),Object(o.h)(U,{path:E.URL_PREFIX+"/config",db:e}),Object(o.h)(K,{path:E.URL_PREFIX+"/sync",db:e})):"Loading..."},e}(o.Component),En=function(t){function e(){return t.apply(this,arguments)||this}Sn(e,t);var n=e.prototype;return n.componentWillMount=function(){m(this.props.to,!0)},n.render=function(){return null},e}(o.Component);e.default=jn},"d+Dk":function(t,e,n){t.exports=function(t){"use strict";var e=void 0;function n(t,n){var r=void 0,i="html"===n?"text/html":"application/xml",o=void 0,s=void 0,a=void 0;"html"===n?(a="body",s="<!DOCTYPE html>\n<html><body>"+t+"</body></html>"):(a="xml",s='<?xml version="1.0" encoding="UTF-8"?>\n<xml>'+t+"</xml>");try{r=(new DOMParser).parseFromString(s,i)}catch(t){o=t}if(r||"html"!==n||((r=e||(e=function(){if(document.implementation&&document.implementation.createHTMLDocument)return document.implementation.createHTMLDocument("");var t=document.createElement("iframe");return t.style.cssText="position:absolute; left:0; top:-999em; width:1px; height:1px; overflow:hidden;",t.setAttribute("sandbox","allow-forms"),document.body.appendChild(t),t.contentWindow.document}())).open(),r.write(s),r.close()),r){var u=r.getElementsByTagName(a)[0],c=u.firstChild;return t&&!c&&(u.error="Document parse failed."),c&&"parsererror"===String(c.nodeName).toLowerCase()&&(c.removeChild(c.firstChild),c.removeChild(c.lastChild),u.error=c.textContent||c.nodeValue||o||"Unknown error",u.removeChild(c)),u}}var r={};function i(t,e,n){if(3===t.nodeType){var r="textContent"in t?t.textContent:t.nodeValue||"";if(!1!==i.options.trim){var s=0===e||e===n.length-1;if((!(r=r.match(/^[\s\n]+$/g)&&"all"!==i.options.trim?" ":r.replace(/(^[\s\n]+|[\s\n]+$)/g,"all"===i.options.trim||s?"":" "))||" "===r)&&n.length>1&&s)return null}return r}if(1!==t.nodeType)return null;var a=String(t.nodeName).toLowerCase();if("script"===a&&!i.options.allowScripts)return null;var u,c,l=i.h(a,function(t){var e=t&&t.length;if(!e)return null;for(var n={},r=0;r<e;r++){var o=t[r],s=o.name,a=o.value;""===a&&(a=!0),"on"===s.substring(0,2)&&i.options.allowEvents&&(a=new Function(a)),n[s]=a}return n}(t.attributes),(u=t.childNodes,(c=u&&Array.prototype.map.call(u,i).filter(o))&&c.length?c:null));return i.visitor&&i.visitor(l),l}var o=function(t){return t},s={};function a(t,e,o,a,c){var l=n(t,e);if(l&&l.error)throw new Error(l.error);var h=l&&l.body||l;u.map=a||s;var f=h&&function(t,e,n,o){return i.visitor=e,i.h=n,i.options=o||r,i(t)}(h,u,o,c);return u.map=null,f&&f.children||null}function u(t){var e=t.nodeName.toLowerCase(),n=u.map;n&&n.hasOwnProperty(e)?(t.nodeName=n[e],t.attributes=Object.keys(t.attributes||{}).reduce(function(e,n){return e[function(t){return t.replace(/-(.)/g,function(t,e){return e.toUpperCase()})}(n)]=t.attributes[n],e},{})):t.nodeName=e.replace(/[^a-z0-9-]/i,"")}var c=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},l=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},h=void 0;return function(e){function n(){return c(this,n),l(this,e.apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(n,e),n.setReviver=function(t){h=t},n.prototype.shouldComponentUpdate=function(t){var e=t.wrap,n=t.type,r=t.markup,i=this.props;return e!==i.wrap||n!==i.type||r!==i.markup},n.prototype.setComponents=function(t){if(this.map={},t)for(var e in t)if(t.hasOwnProperty(e)){var n=e.replace(/([A-Z]+)([A-Z][a-z0-9])|([a-z0-9]+)([A-Z])/g,"$1$3-$2$4").toLowerCase();this.map[n]=t[e]}},n.prototype.render=function(e){var n=e.wrap,r=void 0===n||n,i=e.type,o=e.markup,s=e.components,u=e.reviver,c=e.onError,l=e["allow-scripts"],f=e["allow-events"],p=e.trim,d=function(t,e){var n={};for(var r in t)e.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r]);return n}(e,["wrap","type","markup","components","reviver","onError","allow-scripts","allow-events","trim"]),g=u||this.reviver||this.constructor.prototype.reviver||h||t.h,v=void 0;this.setComponents(s);var m={allowScripts:l,allowEvents:f,trim:p};try{v=a(o,i,g,this.map,m)}catch(t){c?c({error:t}):"undefined"!=typeof console&&console.error&&console.error("preact-markup: "+t)}if(!1===r)return v&&v[0]||null;var b=d.hasOwnProperty("className")?"className":"class",y=d[b];return y?y.splice?y.splice(0,0,"markup"):"string"==typeof y?d[b]+=" markup":"object"==typeof y&&(y.markup=!0):d[b]="markup",g("div",d,v||null)},n}(t.Component)}(n("HteQ"))},fh8t:function(t,e,n){function r(){return(r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}var i=n("HteQ"),o=n("d+Dk"),s=n("Ax1p");t.exports=function(t,e){var n,a=(e=e||{}).h||i.h;if("string"==typeof t)n=t,t={};else{if(!t||"string"!=typeof t.markdown)throw new Error("Invalid arguments. Markdown requires either a `<String>` or object: `{markdown: <String>}`");n=t.markdown}var u=t.markupOpts||e.markupOpts||{},c=t.markdownOpts||e.markdownOpts||{};return a(o,r({markup:s(n,c),trim:!1,type:"html"},u))}}});
//# sourceMappingURL=ssr-bundle.js.map